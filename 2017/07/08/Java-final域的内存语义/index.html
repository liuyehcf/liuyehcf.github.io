<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="阅读更多">
<meta property="og:type" content="article">
<meta property="og:title" content="Java-final域的内存语义">
<meta property="og:url" content="http://example.com/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/index.html">
<meta property="og:site_name" content="Liuye Notebook">
<meta property="og:description" content="阅读更多">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-07-08T13:05:00.000Z">
<meta property="article:modified_time" content="2024-03-18T13:37:51.000Z">
<meta property="article:author" content="Liuyehcf">
<meta property="article:tag" content="摘录">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Java-final域的内存语义 | Liuye Notebook</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Liuye Notebook</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-explore">

    <a href="/explore/" rel="section"><i class="fa fa-sitemap fa-fw"></i>发现</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Liuyehcf">
      <meta itemprop="description" content="大音希声，大象无形">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liuye Notebook">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java-final域的内存语义
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-08 21:05:00" itemprop="dateCreated datePublished" datetime="2017-07-08T21:05:00+08:00">2017-07-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-18 21:37:51" itemprop="dateModified" datetime="2024-03-18T21:37:51+08:00">2024-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java-Virtual-Machine/" itemprop="url" rel="index"><span itemprop="name">Java Virtual Machine</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Java-Virtual-Machine/Java-Memory-Model/" itemprop="url" rel="index"><span itemprop="name">Java Memory Model</span></a>
                </span>
            </span>

          
            <span id="/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/" class="post-meta-item leancloud_visitors" data-flag-title="Java-final域的内存语义" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/07/08/Java-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>阅读更多</strong></p>
<span id="more"></span>
<h1 id="1-前言"><a class="markdownIt-Anchor" href="#1-前言"></a> 1 前言</h1>
<p>本篇博客主要介绍final的内存语义</p>
<h1 id="2-final域的重排序规则"><a class="markdownIt-Anchor" href="#2-final域的重排序规则"></a> 2 final域的重排序规则</h1>
<p>对于final域，编译器和处理器要遵守两个重要排序规则</p>
<ul>
<li>在构造函数内对一个final域的写入，与随后把这个被构造对象的引用赋值给一个引用变量，这两个操作之间不能重排序</li>
<li>初次读一个包含final域的对象的引用，与随后初次读这个final域，这两个操作之间不能重排序</li>
</ul>
<p><strong>我们将通过以下程序中两个线程的交互来说明这两个规则</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalExample</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;<span class="comment">//普通变量</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> j;<span class="comment">//final变量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> FinalExample obj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FinalExample</span><span class="params">()</span> &#123;<span class="comment">//构造函数</span></span><br><span class="line">        i = <span class="number">1</span>;<span class="comment">//写普通域</span></span><br><span class="line">        j = <span class="number">2</span>;<span class="comment">//写final域</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writer</span><span class="params">()</span> &#123;<span class="comment">//写线程A执行</span></span><br><span class="line">        obj = <span class="keyword">new</span> <span class="title class_">FinalExample</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reader</span><span class="params">()</span> &#123;<span class="comment">//读线程B执行</span></span><br><span class="line">        <span class="type">FinalExample</span> <span class="variable">object</span> <span class="operator">=</span> obj;<span class="comment">//读对象引用</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> object.i;<span class="comment">//读普通域</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> object.j;<span class="comment">//读final域</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="21-写final域的重排序规则"><a class="markdownIt-Anchor" href="#21-写final域的重排序规则"></a> 2.1 写final域的重排序规则</h2>
<p>写final域的重排序规则禁止把final域的写重排序到构造函数之外。这个规则的实现包含以下2方面</p>
<ol>
<li>JMM禁止编译器把final域的写重排序到构造函数之外</li>
<li>编译器会在final域的写之后，构造函数return之前，插入一个StoreStore屏障。这个屏障禁止处理器把final域的写重排序到构造函数之外</li>
</ol>
<p>现在分析write方法，write只包含一行代码<code>obj = new FinalExample();</code>，这行代码包含以下两个步骤</p>
<ol>
<li>构造一个FinalExample类型的对象</li>
<li>把这个对象的引用赋值给引用变量obj</li>
</ol>
<p>假设线程B读对象引用与读对象成员之间没有重排序，那么下图就是一种可能的执行顺序</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNFUVVFTkNFIiBoZWlnaHQ9IjQ5NnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6Mzg3cHg7aGVpZ2h0OjQ5NnB4O2JhY2tncm91bmQ6I0VFRUJEQzsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM4NyA0OTYiIHdpZHRoPSIzODdweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxyZWN0IGZpbGw9IiNFRUVCREMiIGhlaWdodD0iNDk2IiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMzg3IiB4PSIwIiB5PSIwIi8+PHJlY3QgZmlsbD0iI0ZGRkZDQyIgaGVpZ2h0PSIyNi42NDA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiNGRkREODg7c3Ryb2tlLXdpZHRoOjM7IiB3aWR0aD0iMzc2LjIzMDUiIHg9IjUiIHk9IjUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM1NS4yMSIgeD0iMTAiIHk9IjIwIj5QbGVhc2UmIzE2MDt1c2UmIzE2MDsnIW9wdGlvbiYjMTYwO2hhbmR3cml0dGVuJiMxNjA7dHJ1ZScmIzE2MDt0byYjMTYwO2VuYWJsZSYjMTYwO2hhbmR3cml0dGVuPC90ZXh0PjxnPjx0aXRsZT4mIzMyNDQ3OyYjMzEyNDM7QTwvdGl0bGU+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwIiBwb2ludHM9IjY2LjgxNDcsNzYuNDI5Nyw2Ni44MTQ3LDc2LjQ5OTcsNjguNDE0Nyw3Ni4yOTE2LDcwLjAxNDcsNzYuNDk0MSw3MS42MTQ3LDc2LjU2MjksNzMuMjE0Nyw3Ni4xOTE5LDc0LjgxNDcsNzYuNDI5Nyw3NC43MzY5LDc2LjQyOTcsNzQuMzg4Miw4Ni40NzE2LDc0LjQzMTIsOTYuNTEzNiw3NC43NDY1LDEwNi41NTU1LDc0LjEyMzMsMTE2LjU5NzUsNzUuMzY4MywxMjYuNjM5NCw3NC4xODQ0LDEzNi42ODEzLDc0LjYxNjksMTQ2LjcyMzMsNzUuMjQ2NiwxNTYuNzY1Miw3NC43Mjg5LDE2Ni44MDcyLDc0Ljg4MjksMTc2Ljg0OTEsNzQuNzgyNywxODYuODkxLDc0Ljk5MzIsMTk2LjkzMyw3NS4wNTM4LDIwNi45NzQ5LDc1LjQwMDMsMjE3LjAxNjksNzUuNDg1NywyMjcuMDU4OCw3NS40OTM5LDIzNy4xMDA3LDc1LjA2OTMsMjQ3LjE0MjcsNzUuMjc4MiwyNTcuMTg0Niw3NS41MTY5LDI2Ny4yMjY2LDc0LjA5MzUsMjc3LjI2ODUsNzUuNDkzMiwyODcuMzEwNCw3NC41MTgxLDI5Ny4zNTI0LDc1LjM0ODUsMzA3LjM5NDMsNzQuMzE5NiwzMTcuNDM2Myw3NC43NDYyLDMyNy40NzgyLDc1LjU1NjMsMzM3LjUyMDEsNzQuNzY1OSwzNDcuNTYyMSw3NC45MiwzNTcuNjA0LDc1LjE1MzMsMzY3LjY0Niw3NS4yMzA5LDM3Ny42ODc5LDc0LjgxMDcsMzg3LjcyOTksNzUuMTAxOSwzOTcuNzcxOCw3NC4yNDIyLDQwNy44MTM3LDc1LjA5OSw0MTcuODU1Nyw3NS4zNjI4LDQyNy44OTc2LDc1LjI1OTIsNDM3LjkzOTYsNzUuNDI3Nyw0NDcuOTgxNSw3NC44MTQ3LDQ1OC4wMjM0LDc0LjgxNDcsNDU3Ljg2MjQsNzMuMjE0Nyw0NTcuODA2LDcxLjYxNDcsNDU3LjgxNjMsNzAuMDE0Nyw0NTguMDAzOCw2OC40MTQ3LDQ1Ny45NTc5LDY2LjgxNDcsNDU4LjAyMzQsNjcuNDk2MSw0NTguMDIzNCw2Ni42NCw0NDcuOTgxNSw2Ni40NzE2LDQzNy45Mzk2LDY3LjA0MjksNDI3Ljg5NzYsNjYuMTQ3OCw0MTcuODU1Nyw2Ni4yOTU1LDQwNy44MTM3LDY3LjQ2MzYsMzk3Ljc3MTgsNjcuMjUwMywzODcuNzI5OSw2Ny41NDkxLDM3Ny42ODc5LDY2LjQ5MjksMzY3LjY0Niw2Ny4xMzM4LDM1Ny42MDQsNjcuNDA1MSwzNDcuNTYyMSw2Ni4zNDIyLDMzNy41MjAxLDY2LjcxODgsMzI3LjQ3ODIsNjYuOTQwNiwzMTcuNDM2Myw2Ny40NjY0LDMwNy4zOTQzLDY2LjgxMDUsMjk3LjM1MjQsNjcuMjc3MiwyODcuMzEwNCw2Ni4yNjA5LDI3Ny4yNjg1LDY2LjEzNzQsMjY3LjIyNjYsNjcuMzE4MywyNTcuMTg0Niw2Ni4wOTc3LDI0Ny4xNDI3LDY3LjMyMzYsMjM3LjEwMDcsNjcuMDIxMywyMjcuMDU4OCw2Ni41NDY3LDIxNy4wMTY5LDY2LjQ2MDksMjA2Ljk3NDksNjcuMjczNCwxOTYuOTMzLDY2LjUxNTMsMTg2Ljg5MSw2Ny40MDY1LDE3Ni44NDkxLDY2LjI2MTksMTY2LjgwNzIsNjcuNDMyMSwxNTYuNzY1Miw2Ny4yOTksMTQ2LjcyMzMsNjcuMDU5NiwxMzYuNjgxMyw2Ni44NjE5LDEyNi42Mzk0LDY3LjU0MTMsMTE2LjU5NzUsNjcuNDI4MiwxMDYuNTU1NSw2Ni45ODM5LDk2LjUxMzYsNjcuMDgyOCw4Ni40NzE2LDY2LjgxNDcsNzYuNDI5NyIvPjxwYXRoIGQ9Ik03MCw3Ni40Mjk3IEw3MC4yODAyLDc2LjQyOTcgTDY5LjQ0NzYsODYuNDcxNiBMNzAuMjU3Nyw5Ni41MTM2IEw3MC41MzI5LDEwNi41NTU1IEw2OS4wNDg4LDExNi41OTc1IEw2OS44OTY0LDEyNi42Mzk0IEw2OS40MzEzLDEzNi42ODEzIEw2OS40ODg3LDE0Ni43MjMzIEw2OS45MDkxLDE1Ni43NjUyIEw2OS4wNzgyLDE2Ni44MDcyIEw3MC43MzgyLDE3Ni44NDkxIEw2OS4xNTk2LDE4Ni44OTEgTDY5LjczNjMsMTk2LjkzMyBMNzAuNTc1OSwyMDYuOTc0OSBMNjkuODg1NiwyMTcuMDE2OSBMNzAuMDkxLDIyNy4wNTg4IEw2OS45NTc0LDIzNy4xMDA3IEw3MC4yMzgsMjQ3LjE0MjcgTDcwLjMxODgsMjU3LjE4NDYgTDcwLjc4MDksMjY3LjIyNjYgTDcwLjg5NDcsMjc3LjI2ODUgTDcwLjkwNTcsMjg3LjMxMDQgTDcwLjMzOTUsMjk3LjM1MjQgTDcwLjYxODEsMzA3LjM5NDMgTDcwLjkzNjMsMzE3LjQzNjMgTDY5LjAzODQsMzI3LjQ3ODIgTDcwLjkwNDcsMzM3LjUyMDEgTDY5LjYwNDcsMzQ3LjU2MjEgTDcwLjcxMTcsMzU3LjYwNCBMNjkuMzQsMzY3LjY0NiBMNjkuOTA4NywzNzcuNjg3OSBMNzAuOTg4OCwzODcuNzI5OSBMNjkuOTM1LDM5Ny43NzE4IEw3MC4xNDA0LDQwNy44MTM3IEw3MC40NTE1LDQxNy44NTU3IEw3MC41NTUsNDI3Ljg5NzYgTDY5Ljk5NDgsNDM3LjkzOTYgTDcwLjM4Myw0NDcuOTgxNSBMNzAsNDU4LjAyMzQiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDBGRjtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiLz48L2c+PGc+PHRpdGxlPiYjMzI0NDc7JiMzMTI0MztCPC90aXRsZT48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIHBvaW50cz0iMTM2LjQ2MDYsNzYuNDI5NywxMzYuNDYwNiw3Ni40OTk3LDEzOC4wNjA2LDc2LjI5MTYsMTM5LjY2MDYsNzYuNDk0MSwxNDEuMjYwNiw3Ni41NjI5LDE0Mi44NjA2LDc2LjE5MTksMTQ0LjQ2MDYsNzYuNDI5NywxNDQuMzgyOCw3Ni40Mjk3LDE0NC4wMzQxLDg2LjQ3MTYsMTQ0LjA3NzEsOTYuNTEzNiwxNDQuMzkyNCwxMDYuNTU1NSwxNDMuNzY5MiwxMTYuNTk3NSwxNDUuMDE0MiwxMjYuNjM5NCwxNDMuODMwMywxMzYuNjgxMywxNDQuMjYyOCwxNDYuNzIzMywxNDQuODkyNSwxNTYuNzY1MiwxNDQuMzc0OCwxNjYuODA3MiwxNDQuNTI4OCwxNzYuODQ5MSwxNDQuNDI4NiwxODYuODkxLDE0NC42MzkxLDE5Ni45MzMsMTQ0LjY5OTcsMjA2Ljk3NDksMTQ1LjA0NjIsMjE3LjAxNjksMTQ1LjEzMTYsMjI3LjA1ODgsMTQ1LjEzOTgsMjM3LjEwMDcsMTQ0LjcxNTIsMjQ3LjE0MjcsMTQ0LjkyNDEsMjU3LjE4NDYsMTQ1LjE2MjgsMjY3LjIyNjYsMTQzLjczOTQsMjc3LjI2ODUsMTQ1LjEzOTEsMjg3LjMxMDQsMTQ0LjE2NDEsMjk3LjM1MjQsMTQ0Ljk5NDQsMzA3LjM5NDMsMTQzLjk2NTUsMzE3LjQzNjMsMTQ0LjM5MjEsMzI3LjQ3ODIsMTQ1LjIwMjIsMzM3LjUyMDEsMTQ0LjQxMTgsMzQ3LjU2MjEsMTQ0LjU2NTksMzU3LjYwNCwxNDQuNzk5MiwzNjcuNjQ2LDE0NC44NzY4LDM3Ny42ODc5LDE0NC40NTY2LDM4Ny43Mjk5LDE0NC43NDc4LDM5Ny43NzE4LDE0My44ODgxLDQwNy44MTM3LDE0NC43NDQ5LDQxNy44NTU3LDE0NS4wMDg4LDQyNy44OTc2LDE0NC45MDUxLDQzNy45Mzk2LDE0NS4wNzM2LDQ0Ny45ODE1LDE0NC40NjA2LDQ1OC4wMjM0LDE0NC40NjA2LDQ1Ny44NjI0LDE0Mi44NjA2LDQ1Ny44MDYsMTQxLjI2MDYsNDU3LjgxNjMsMTM5LjY2MDYsNDU4LjAwMzgsMTM4LjA2MDYsNDU3Ljk1NzksMTM2LjQ2MDYsNDU4LjAyMzQsMTM3LjE0Miw0NTguMDIzNCwxMzYuMjg1OSw0NDcuOTgxNSwxMzYuMTE3NSw0MzcuOTM5NiwxMzYuNjg4OCw0MjcuODk3NiwxMzUuNzkzNyw0MTcuODU1NywxMzUuOTQxNCw0MDcuODEzNywxMzcuMTA5NSwzOTcuNzcxOCwxMzYuODk2MiwzODcuNzI5OSwxMzcuMTk1LDM3Ny42ODc5LDEzNi4xMzg4LDM2Ny42NDYsMTM2Ljc3OTgsMzU3LjYwNCwxMzcuMDUxLDM0Ny41NjIxLDEzNS45ODgxLDMzNy41MjAxLDEzNi4zNjQ3LDMyNy40NzgyLDEzNi41ODY1LDMxNy40MzYzLDEzNy4xMTIzLDMwNy4zOTQzLDEzNi40NTY0LDI5Ny4zNTI0LDEzNi45MjMxLDI4Ny4zMTA0LDEzNS45MDY4LDI3Ny4yNjg1LDEzNS43ODMzLDI2Ny4yMjY2LDEzNi45NjQyLDI1Ny4xODQ2LDEzNS43NDM2LDI0Ny4xNDI3LDEzNi45Njk1LDIzNy4xMDA3LDEzNi42NjcyLDIyNy4wNTg4LDEzNi4xOTI2LDIxNy4wMTY5LDEzNi4xMDY4LDIwNi45NzQ5LDEzNi45MTkzLDE5Ni45MzMsMTM2LjE2MTIsMTg2Ljg5MSwxMzcuMDUyNCwxNzYuODQ5MSwxMzUuOTA3OCwxNjYuODA3MiwxMzcuMDc4LDE1Ni43NjUyLDEzNi45NDQ5LDE0Ni43MjMzLDEzNi43MDU1LDEzNi42ODEzLDEzNi41MDc4LDEyNi42Mzk0LDEzNy4xODcyLDExNi41OTc1LDEzNy4wNzQxLDEwNi41NTU1LDEzNi42Mjk4LDk2LjUxMzYsMTM2LjcyODcsODYuNDcxNiwxMzYuNDYwNiw3Ni40Mjk3Ii8+PHBhdGggZD0iTTEzOS42MjkzLDc2LjQyOTcgTDEzOS45MDk1LDc2LjQyOTcgTDEzOS4wNzY5LDg2LjQ3MTYgTDEzOS44ODcsOTYuNTEzNiBMMTQwLjE2MjIsMTA2LjU1NTUgTDEzOC42NzgxLDExNi41OTc1IEwxMzkuNTI1NywxMjYuNjM5NCBMMTM5LjA2MDYsMTM2LjY4MTMgTDEzOS4xMTgsMTQ2LjcyMzMgTDEzOS41Mzg0LDE1Ni43NjUyIEwxMzguNzA3NSwxNjYuODA3MiBMMTQwLjM2NzUsMTc2Ljg0OTEgTDEzOC43ODg5LDE4Ni44OTEgTDEzOS4zNjU2LDE5Ni45MzMgTDE0MC4yMDUyLDIwNi45NzQ5IEwxMzkuNTE0OSwyMTcuMDE2OSBMMTM5LjcyMDMsMjI3LjA1ODggTDEzOS41ODY3LDIzNy4xMDA3IEwxMzkuODY3MywyNDcuMTQyNyBMMTM5Ljk0ODEsMjU3LjE4NDYgTDE0MC40MTAyLDI2Ny4yMjY2IEwxNDAuNTI0LDI3Ny4yNjg1IEwxNDAuNTM1LDI4Ny4zMTA0IEwxMzkuOTY4OCwyOTcuMzUyNCBMMTQwLjI0NzQsMzA3LjM5NDMgTDE0MC41NjU2LDMxNy40MzYzIEwxMzguNjY3NywzMjcuNDc4MiBMMTQwLjUzNCwzMzcuNTIwMSBMMTM5LjIzNCwzNDcuNTYyMSBMMTQwLjM0MTEsMzU3LjYwNCBMMTM4Ljk2OTMsMzY3LjY0NiBMMTM5LjUzOCwzNzcuNjg3OSBMMTQwLjYxODEsMzg3LjcyOTkgTDEzOS41NjQzLDM5Ny43NzE4IEwxMzkuNzY5Nyw0MDcuODEzNyBMMTQwLjA4MDgsNDE3Ljg1NTcgTDE0MC4xODQzLDQyNy44OTc2IEwxMzkuNjI0MSw0MzcuOTM5NiBMMTQwLjAxMjMsNDQ3Ljk4MTUgTDEzOS42MjkzLDQ1OC4wMjM0IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwRkY7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUuMCw1LjA7Ii8+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSImIzMyNDQ3OyYjMzEyNDM7QSI+PHBvbHlnb24gZmlsbD0iIzFFOTBGRiIgcG9pbnRzPSI0My41LDQxLjY0MDYsNDMuNSw0MS44NTA4LDU0LjQyNTksNDEuMjI2Myw2NS4zNTE3LDQxLjgzMzksNzYuMjc3Niw0Mi4wNDAzLDg3LjIwMzQsNDAuOTI3Miw5OC4xMjkzLDQxLjY0MDYsOTguMTE5NCw0MS42MTY3LDk4LjQyODUsNDEuNjU1Nyw5OC43ODc1LDQxLjgxNTQsOTkuMTgxMyw0Mi4wNTksOTkuNDU1Myw0Mi4wMTM1LDk5Ljg5NzEsNDIuMzcyOSwxMDAuMDY3Niw0Mi40NDM1LDk5Ljg0OTQsNDIuNjQ2LDEwMC4xMjkxLDQzLjA1NDcsMTAwLjQ2OTQsNDMuNDg4NiwxMDAuNDU2NCw0My43NzYxLDEwMC42MjkzLDQ0LjE0MDYsMTAwLjY1Miw0NC4xNDA2LDEwMC42MTg3LDQ5Ljg5ODQsMTAwLjY4ODgsNTUuNjU2MywxMDAuNzA5LDYxLjQxNDEsMTAwLjgyNDUsNjcuMTcxOSwxMDAuNjI5Myw3Mi45Mjk3LDEwMC44MzYsNzMuMDE1MywxMDAuNjkyLDczLjM2OTksMTAwLjQxNDgsNzMuNjY5MywxMDAuMzMyNyw3NC4wNDk1LDEwMC4yNTk4LDc0LjQzMzUsOTkuODk3MSw3NC42OTc1LDk5LjgwNTEsNzQuNDc1NCw5OS42MzAxLDc1LjA1MjksOTkuMTUyMSw3NC44OTksOTguOTA0NSw3NS4zMDEyLDk4LjQxOTcsNzUuMTMwOCw5OC4xMjkzLDc1LjQyOTcsOTguMTI5Myw3NS4zNjEyLDg3LjIwMzQsNzYuMTcxMyw3Ni4yNzc2LDc1LjM4MSw2NS4zNTE3LDc1LjUzNSw1NC40MjU5LDc1Ljc2ODMsNDMuNSw3NS40Mjk3LDQzLjU1MzEsNzUuNTU3OSw0My4xNDU5LDc1LjI4Miw0Mi44Mjk1LDc1LjIyNTIsNDIuMzY2Myw3NC44MTQxLDQyLjEyMjEsNzQuOTMxNSw0MS43MzIyLDc0LjY5NzUsNDEuOTAxMSw3NC43Njc0LDQxLjcyMjcsNzQuNDAwNiw0MS42MjgxLDc0LjA2ODUsNDEuMTQ0MSw3My41NzUyLDQwLjk0NTYsNzMuMiw0MSw3Mi45Mjk3LDQwLjc5MjksNzIuOTI5Nyw0MC45ODA0LDY3LjE3MTksNDAuOTM0NSw2MS40MTQxLDQxLjIyNzEsNTUuNjU2Myw0MC45NDE4LDQ5Ljg5ODQsNDEsNDQuMTQwNiw0MC44OTQ0LDQ0LjA5NjksNDEuMjE2Nyw0My44MTYyLDQxLjA4NzUsNDMuMzQ4NSw0MS4yNzk1LDQzLjAxMzcsNDEuNzg1Niw0Mi44MDkyLDQxLjczMjIsNDIuMzcyOSw0MS43ODc4LDQyLjUwNyw0Mi4xNzk1LDQyLjQ1MjYsNDIuMzk4Myw0MS45ODA5LDQyLjgzMzYsNDIuMDMxOCw0My4yMjE4LDQxLjk2ODksNDMuNSw0MS42NDA2IiBzdHlsZT0ic3Ryb2tlOiMwMEJGRkY7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjQTlEQ0RGIiBmb250LWZhbWlseT0iSW1wYWN0IiBmb250LXNpemU9IjE3IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ1LjYyOTMiIHg9IjQ4IiB5PSI2NC40MjA0Ij4mIzMyNDQ3OyYjMzEyNDM7QTwvdGV4dD48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LXRhaWwiIGRhdGEtcGFydGljaXBhbnQ9IiYjMzI0NDc7JiMzMTI0MztBIj48cG9seWdvbiBmaWxsPSIjMUU5MEZGIiBwb2ludHM9IjQzLjUsNDU3LjAyMzQsNDMuNSw0NTcuMjMzNiw1NC40MjU5LDQ1Ni42MDkxLDY1LjM1MTcsNDU3LjIxNjcsNzYuMjc3Niw0NTcuNDIzMSw4Ny4yMDM0LDQ1Ni4zMSw5OC4xMjkzLDQ1Ny4wMjM0LDk4LjExOTQsNDU2Ljk5OTUsOTguNDI4NSw0NTcuMDM4NSw5OC43ODc1LDQ1Ny4xOTgyLDk5LjE4MTMsNDU3LjQ0MTgsOTkuNDU1Myw0NTcuMzk2Myw5OS44OTcxLDQ1Ny43NTU3LDEwMC4wNjc2LDQ1Ny44MjYzLDk5Ljg0OTQsNDU4LjAyODgsMTAwLjEyOTEsNDU4LjQzNzUsMTAwLjQ2OTQsNDU4Ljg3MTQsMTAwLjQ1NjQsNDU5LjE1ODksMTAwLjYyOTMsNDU5LjUyMzQsMTAwLjY1Miw0NTkuNTIzNCwxMDAuNjE4Nyw0NjUuMjgxMywxMDAuNjg4OCw0NzEuMDM5MSwxMDAuNzA5LDQ3Ni43OTY5LDEwMC44MjQ1LDQ4Mi41NTQ3LDEwMC42MjkzLDQ4OC4zMTI1LDEwMC44MzYsNDg4LjM5ODEsMTAwLjY5Miw0ODguNzUyNywxMDAuNDE0OCw0ODkuMDUyMSwxMDAuMzMyNyw0ODkuNDMyMywxMDAuMjU5OCw0ODkuODE2Myw5OS44OTcxLDQ5MC4wODAzLDk5LjgwNTEsNDg5Ljg1ODIsOTkuNjMwMSw0OTAuNDM1Nyw5OS4xNTIxLDQ5MC4yODE4LDk4LjkwNDUsNDkwLjY4NCw5OC40MTk3LDQ5MC41MTM2LDk4LjEyOTMsNDkwLjgxMjUsOTguMTI5Myw0OTAuNzQ0LDg3LjIwMzQsNDkxLjU1NDEsNzYuMjc3Niw0OTAuNzYzOCw2NS4zNTE3LDQ5MC45MTc4LDU0LjQyNTksNDkxLjE1MTEsNDMuNSw0OTAuODEyNSw0My41NTMxLDQ5MC45NDA3LDQzLjE0NTksNDkwLjY2NDksNDIuODI5NSw0OTAuNjA4MSw0Mi4zNjYzLDQ5MC4xOTY5LDQyLjEyMjEsNDkwLjMxNDMsNDEuNzMyMiw0OTAuMDgwMyw0MS45MDExLDQ5MC4xNTAyLDQxLjcyMjcsNDg5Ljc4MzQsNDEuNjI4MSw0ODkuNDUxNCw0MS4xNDQxLDQ4OC45NTgsNDAuOTQ1Niw0ODguNTgyOSw0MSw0ODguMzEyNSw0MC43OTI5LDQ4OC4zMTI1LDQwLjk4MDQsNDgyLjU1NDcsNDAuOTM0NSw0NzYuNzk2OSw0MS4yMjcxLDQ3MS4wMzkxLDQwLjk0MTgsNDY1LjI4MTMsNDEsNDU5LjUyMzQsNDAuODk0NCw0NTkuNDc5Nyw0MS4yMTY3LDQ1OS4xOTksNDEuMDg3NSw0NTguNzMxMyw0MS4yNzk1LDQ1OC4zOTY2LDQxLjc4NTYsNDU4LjE5Miw0MS43MzIyLDQ1Ny43NTU3LDQxLjc4NzgsNDU3Ljg4OTgsNDIuMTc5NSw0NTcuODM1NCw0Mi4zOTgzLDQ1Ny4zNjM3LDQyLjgzMzYsNDU3LjQxNDYsNDMuMjIxOCw0NTcuMzUxNyw0My41LDQ1Ny4wMjM0IiBzdHlsZT0ic3Ryb2tlOiMwMEJGRkY7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjQTlEQ0RGIiBmb250LWZhbWlseT0iSW1wYWN0IiBmb250LXNpemU9IjE3IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ1LjYyOTMiIHg9IjQ4IiB5PSI0NzkuODAzMiI+JiMzMjQ0NzsmIzMxMjQzO0E8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSImIzMyNDQ3OyYjMzEyNDM7QiI+PHBvbHlnb24gZmlsbD0iIzFFOTBGRiIgcG9pbnRzPSIxMTMuMTI5Myw0MS42NDA2LDExMy4xMjkzLDQxLjg1MDgsMTI0LjA2MTgsNDEuMjI2MywxMzQuOTk0Myw0MS44MzM5LDE0NS45MjY4LDQyLjA0MDMsMTU2Ljg1OTMsNDAuOTI3MiwxNjcuNzkxOCw0MS42NDA2LDE2Ny43ODE5LDQxLjYxNjcsMTY4LjA5MSw0MS42NTU3LDE2OC40NSw0MS44MTU0LDE2OC44NDM4LDQyLjA1OSwxNjkuMTE3OCw0Mi4wMTM1LDE2OS41NTk2LDQyLjM3MjksMTY5LjczMDEsNDIuNDQzNSwxNjkuNTExOSw0Mi42NDYsMTY5Ljc5MTYsNDMuMDU0NywxNzAuMTMxOSw0My40ODg2LDE3MC4xMTg5LDQzLjc3NjEsMTcwLjI5MTgsNDQuMTQwNiwxNzAuMzE0Niw0NC4xNDA2LDE3MC4yODEyLDQ5Ljg5ODQsMTcwLjM1MTMsNTUuNjU2MywxNzAuMzcxNSw2MS40MTQxLDE3MC40ODcsNjcuMTcxOSwxNzAuMjkxOCw3Mi45Mjk3LDE3MC40OTg1LDczLjAxNTMsMTcwLjM1NDUsNzMuMzY5OSwxNzAuMDc3Myw3My42NjkzLDE2OS45OTUyLDc0LjA0OTUsMTY5LjkyMjMsNzQuNDMzNSwxNjkuNTU5Niw3NC42OTc1LDE2OS40Njc2LDc0LjQ3NTQsMTY5LjI5MjYsNzUuMDUyOSwxNjguODE0Niw3NC44OTksMTY4LjU2Nyw3NS4zMDEyLDE2OC4wODIyLDc1LjEzMDgsMTY3Ljc5MTgsNzUuNDI5NywxNjcuNzkxOCw3NS4zNjEyLDE1Ni44NTkzLDc2LjE3MTMsMTQ1LjkyNjgsNzUuMzgxLDEzNC45OTQzLDc1LjUzNSwxMjQuMDYxOCw3NS43NjgzLDExMy4xMjkzLDc1LjQyOTcsMTEzLjE4MjQsNzUuNTU3OSwxMTIuNzc1Myw3NS4yODIsMTEyLjQ1ODgsNzUuMjI1MiwxMTEuOTk1Niw3NC44MTQxLDExMS43NTE0LDc0LjkzMTUsMTExLjM2MTUsNzQuNjk3NSwxMTEuNTMwNCw3NC43Njc0LDExMS4zNTIsNzQuNDAwNiwxMTEuMjU3NCw3NC4wNjg1LDExMC43NzM0LDczLjU3NTIsMTEwLjU3NDksNzMuMiwxMTAuNjI5Myw3Mi45Mjk3LDExMC40MjIyLDcyLjkyOTcsMTEwLjYwOTcsNjcuMTcxOSwxMTAuNTYzOCw2MS40MTQxLDExMC44NTY0LDU1LjY1NjMsMTEwLjU3MTEsNDkuODk4NCwxMTAuNjI5Myw0NC4xNDA2LDExMC41MjM3LDQ0LjA5NjksMTEwLjg0Niw0My44MTYyLDExMC43MTY4LDQzLjM0ODUsMTEwLjkwODgsNDMuMDEzNywxMTEuNDE0OSw0Mi44MDkyLDExMS4zNjE1LDQyLjM3MjksMTExLjQxNzEsNDIuNTA3LDExMS44MDg4LDQyLjQ1MjYsMTEyLjAyNzYsNDEuOTgwOSwxMTIuNDYyOSw0Mi4wMzE4LDExMi44NTExLDQxLjk2ODksMTEzLjEyOTMsNDEuNjQwNiIgc3R5bGU9InN0cm9rZTojMDBCRkZGO3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iI0E5RENERiIgZm9udC1mYW1pbHk9IkltcGFjdCIgZm9udC1zaXplPSIxNyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0NS42NjI1IiB4PSIxMTcuNjI5MyIgeT0iNjQuNDIwNCI+JiMzMjQ0NzsmIzMxMjQzO0I8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC10YWlsIiBkYXRhLXBhcnRpY2lwYW50PSImIzMyNDQ3OyYjMzEyNDM7QiI+PHBvbHlnb24gZmlsbD0iIzFFOTBGRiIgcG9pbnRzPSIxMTMuMTI5Myw0NTcuMDIzNCwxMTMuMTI5Myw0NTcuMjMzNiwxMjQuMDYxOCw0NTYuNjA5MSwxMzQuOTk0Myw0NTcuMjE2NywxNDUuOTI2OCw0NTcuNDIzMSwxNTYuODU5Myw0NTYuMzEsMTY3Ljc5MTgsNDU3LjAyMzQsMTY3Ljc4MTksNDU2Ljk5OTUsMTY4LjA5MSw0NTcuMDM4NSwxNjguNDUsNDU3LjE5ODIsMTY4Ljg0MzgsNDU3LjQ0MTgsMTY5LjExNzgsNDU3LjM5NjMsMTY5LjU1OTYsNDU3Ljc1NTcsMTY5LjczMDEsNDU3LjgyNjMsMTY5LjUxMTksNDU4LjAyODgsMTY5Ljc5MTYsNDU4LjQzNzUsMTcwLjEzMTksNDU4Ljg3MTQsMTcwLjExODksNDU5LjE1ODksMTcwLjI5MTgsNDU5LjUyMzQsMTcwLjMxNDYsNDU5LjUyMzQsMTcwLjI4MTIsNDY1LjI4MTMsMTcwLjM1MTMsNDcxLjAzOTEsMTcwLjM3MTUsNDc2Ljc5NjksMTcwLjQ4Nyw0ODIuNTU0NywxNzAuMjkxOCw0ODguMzEyNSwxNzAuNDk4NSw0ODguMzk4MSwxNzAuMzU0NSw0ODguNzUyNywxNzAuMDc3Myw0ODkuMDUyMSwxNjkuOTk1Miw0ODkuNDMyMywxNjkuOTIyMyw0ODkuODE2MywxNjkuNTU5Niw0OTAuMDgwMywxNjkuNDY3Niw0ODkuODU4MiwxNjkuMjkyNiw0OTAuNDM1NywxNjguODE0Niw0OTAuMjgxOCwxNjguNTY3LDQ5MC42ODQsMTY4LjA4MjIsNDkwLjUxMzYsMTY3Ljc5MTgsNDkwLjgxMjUsMTY3Ljc5MTgsNDkwLjc0NCwxNTYuODU5Myw0OTEuNTU0MSwxNDUuOTI2OCw0OTAuNzYzOCwxMzQuOTk0Myw0OTAuOTE3OCwxMjQuMDYxOCw0OTEuMTUxMSwxMTMuMTI5Myw0OTAuODEyNSwxMTMuMTgyNCw0OTAuOTQwNywxMTIuNzc1Myw0OTAuNjY0OSwxMTIuNDU4OCw0OTAuNjA4MSwxMTEuOTk1Niw0OTAuMTk2OSwxMTEuNzUxNCw0OTAuMzE0MywxMTEuMzYxNSw0OTAuMDgwMywxMTEuNTMwNCw0OTAuMTUwMiwxMTEuMzUyLDQ4OS43ODM0LDExMS4yNTc0LDQ4OS40NTE0LDExMC43NzM0LDQ4OC45NTgsMTEwLjU3NDksNDg4LjU4MjksMTEwLjYyOTMsNDg4LjMxMjUsMTEwLjQyMjIsNDg4LjMxMjUsMTEwLjYwOTcsNDgyLjU1NDcsMTEwLjU2MzgsNDc2Ljc5NjksMTEwLjg1NjQsNDcxLjAzOTEsMTEwLjU3MTEsNDY1LjI4MTMsMTEwLjYyOTMsNDU5LjUyMzQsMTEwLjUyMzcsNDU5LjQ3OTcsMTEwLjg0Niw0NTkuMTk5LDExMC43MTY4LDQ1OC43MzEzLDExMC45MDg4LDQ1OC4zOTY2LDExMS40MTQ5LDQ1OC4xOTIsMTExLjM2MTUsNDU3Ljc1NTcsMTExLjQxNzEsNDU3Ljg4OTgsMTExLjgwODgsNDU3LjgzNTQsMTEyLjAyNzYsNDU3LjM2MzcsMTEyLjQ2MjksNDU3LjQxNDYsMTEyLjg1MTEsNDU3LjM1MTcsMTEzLjEyOTMsNDU3LjAyMzQiIHN0eWxlPSJzdHJva2U6IzAwQkZGRjtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiNBOURDREYiIGZvbnQtZmFtaWx5PSJJbXBhY3QiIGZvbnQtc2l6ZT0iMTciIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDUuNjYyNSIgeD0iMTE3LjYyOTMiIHk9IjQ3OS44MDMyIj4mIzMyNDQ3OyYjMzEyNDM7QjwvdGV4dD48L2c+PHBhdGggZD0iTTgsOTEuNDI5NyBMOC4xODY4LDkxLjQyOTcgTDcuNjMxNyw5Ni40Mjk3IEw4LjE3MTgsMTAxLjQyOTcgTDguMzU1MywxMDYuNDI5NyBMNy4zNjU5LDExMS40Mjk3IEw4LDExNi40Mjk3IEw4LDExNi4yMjI1IEwxNy42MTU0LDExNS4yOTI0IEwyNy4yMzA4LDExNS40MDcgTDM2Ljg0NjIsMTE2LjI0NzkgTDQ2LjQ2MTUsMTE0LjU4NiBMNTYuMDc2OSwxMTcuOTA2MSBMNjUuNjkyMywxMTQuNzQ4OSBMNzUuMzA3NywxMTUuOTAyMyBMODQuOTIzMSwxMTcuNTgxNSBMOTQuNTM4NSwxMTYuMjAwOSBMMTA0LjE1MzgsMTE2LjYxMTcgTDExMy43NjkyLDExNi4zNDQ1IEwxMjMuMzg0NiwxMTYuOTA1OCBMMTMzLDExNi40Mjk3IEwxMzMuMjEyNiwxMTYuNDI5NyBMMTMzLjUyMDYsMTEzLjQyOTcgTDEzMy41OTY1LDExMC40Mjk3IEwxMzMuNjAzOCwxMDcuNDI5NyBMMTMzLjIyNjMsMTA0LjQyOTcgTDEzMywxMDEuNDI5NyBMMTMzLjI5MTQsMTAxLjcyMTEgTDEzMS40NDE0LDk5Ljg3MTEgTDEyOC41NDY3LDk2Ljk3NjQgTDEyNy40MjY1LDk1Ljg1NjIgTDEyNC44MTM2LDkzLjI0MzMgTDEyMyw5MS40Mjk3IEwxMjMsOTIuODUzMiBMMTEzLjQxNjcsOTAuMTA5NiBMMTAzLjgzMzMsOTEuMjQ3IEw5NC4yNSw5My40MDczIEw4NC42NjY3LDkxLjI5OTcgTDc1LjA4MzMsOTEuNzEwNSBMNjUuNSw5Mi4zMzI3IEw1NS45MTY3LDkyLjUzOTYgTDQ2LjMzMzMsOTEuNDE5MyBMMzYuNzUsOTIuMTk1NiBMMjcuMTY2Nyw4OS45MDMyIEwxNy41ODMzLDkyLjE4ODEgTDgsOTEuNDI5NyIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEyMyw5MS40Mjk3IEwxMjMuNDg3Myw5MS40Mjk3IEwxMjMuMzk1MSw5My40Mjk3IEwxMjMuNTQ0OSw5NS40Mjk3IEwxMjIuNTcwNiw5Ny40Mjk3IEwxMjIuNDIwMyw5OS40Mjk3IEwxMjMsMTAxLjQyOTcgTDEyMywxMDAuODc3MyBMMTI1LDEwMS4zNzczIEwxMjcsMTAxLjI1NSBMMTI5LDEwMi4wMzU0IEwxMzEsMTAxLjI3NDQgTDEzMywxMDEuNDI5NyBMMTMyLjc4NDQsMTAxLjIxNDEgTDEzMS4xNDM1LDk5LjU3MzIgTDEyOC41ODA5LDk3LjAxMDYgTDEyNi42NzM3LDk1LjEwMzQgTDEyNS40MDc5LDkzLjgzNzYgTDEyMyw5MS40Mjk3IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuMDAwMSIgeD0iMTQiIHk9IjEwOC40OTY2Ij4mIzI2NTAwOyYjMzY4OTY7JiMyMDk4OTsmIzI1OTY4OyYjMjQzMjA7JiMyMjk4NzsmIzI1MTkxOyYjMzQ4OTI7PC90ZXh0PjxwYXRoIGQ9Ik0yNiwxMjYuNTYyNSBMMjYuMTg2OCwxMjYuNTYyNSBMMjUuNjMxNywxMzQuNTYyNSBMMjYuMTcxOCwxNDIuNTYyNSBMMjYuMzU1MywxNTAuNTYyNSBMMjUuMzY1OSwxNTguNTYyNSBMMjYsMTY2LjU2MjUgTDI2LDE2Ni4zNTUzIEwzNS43Nzc4LDE2NS40MjUyIEw0NS41NTU2LDE2NS41Mzk4IEw1NS4zMzMzLDE2Ni4zODA3IEw2NS4xMTExLDE2NC43MTg4IEw3NC44ODg5LDE2OC4wMzg5IEw4NC42NjY3LDE2NC44ODE4IEw5NC40NDQ0LDE2Ni4wMzUxIEwxMDQuMjIyMiwxNjcuNzE0NCBMMTE0LDE2Ni41NjI1IEwxMTMuOTIzOCwxNjYuNTYyNSBMMTE0LjA2MDcsMTYwLjU2MjUgTDExMy45NzE2LDE1NC41NjI1IEwxMTQuMTU4NywxNDguNTYyNSBMMTE0LjIxMjYsMTQyLjU2MjUgTDExNCwxMzYuNTYyNSBMMTE0LjM2ODEsMTM2LjkzMDYgTDExMi40MjE4LDEzNC45ODQzIEwxMTAuNDI2OSwxMzIuOTg5NCBMMTA4LjE2LDEzMC43MjI1IEwxMDYuMjkxNCwxMjguODUzOSBMMTA0LDEyNi41NjI1IEwxMDQsMTI4LjQzNTEgTDk0LjI1LDEyNC42MzkzIEw4NC41LDEyOC4zNzE5IEw3NC43NSwxMjUuNzcxOCBMNjUsMTI3Ljk4NiBMNTUuMjUsMTI1LjI0MjQgTDQ1LjUsMTI2LjM3OTggTDM1Ljc1LDEyOC41NDAxIEwyNiwxMjYuNTYyNSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEwNCwxMjYuNTYyNSBMMTAzLjk1NjcsMTI2LjU2MjUgTDEwNC4wOTM2LDEyOC41NjI1IEwxMDQuMzAxLDEzMC41NjI1IEwxMDQuMzcsMTMyLjU2MjUgTDEwMy45OTY1LDEzNC41NjI1IEwxMDQsMTM2LjU2MjUgTDEwNCwxMzYuODE3OCBMMTA2LDEzNi4wNTM3IEwxMDgsMTM2LjgxNTMgTDExMCwxMzcuMDQ5OCBMMTEyLDEzNi45NTc2IEwxMTQsMTM2LjU2MjUgTDExNC4zODUzLDEzNi45NDc4IEwxMTEuNjk2NCwxMzQuMjU4OSBMMTA5LjU5MDEsMTMyLjE1MjYgTDEwNy42MDk0LDEzMC4xNzE5IEwxMDUuOTYzLDEyOC41MjU1IEwxMDQsMTI2LjU2MjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY3LjAwNTkiIHg9IjMyIiB5PSIxNDMuNjI5NCI+JiMyMDg4OTtmaW5hbCYjMjI0OTU7JiM2NTMwNjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzEuMDQiIHg9IjMyIiB5PSIxNTguNzYyMiI+aiA9IDI8L3RleHQ+PHBhdGggZD0iTTEyLDE3Ni44MjgxIEwxMi4xODY4LDE3Ni44MjgxIEwxMS42MzE3LDE4MS44MjgxIEwxMi4xNzE4LDE4Ni44MjgxIEwxMi4zNTUzLDE5MS44MjgxIEwxMS4zNjU5LDE5Ni44MjgxIEwxMiwyMDEuODI4MSBMMTIsMjAxLjYyMDkgTDIxLjY2NjcsMjAwLjY5MDggTDMxLjMzMzMsMjAwLjgwNTUgTDQxLDIwMS42NDY0IEw1MC42NjY3LDE5OS45ODQ1IEw2MC4zMzMzLDIwMy4zMDQ1IEw3MCwyMDAuMTQ3NCBMNzkuNjY2NywyMDEuMzAwNyBMODkuMzMzMywyMDIuOTggTDk5LDIwMS41OTk0IEwxMDguNjY2NywyMDIuMDEwMSBMMTE4LjMzMzMsMjAxLjc0MjkgTDEyOCwyMDEuODI4MSBMMTI4LjE1ODcsMjAxLjgyODEgTDEyOC4yMTI2LDE5OC44MjgxIEwxMjguNTIwNiwxOTUuODI4MSBMMTI4LjU5NjUsMTkyLjgyODEgTDEyOC42MDM4LDE4OS44MjgxIEwxMjgsMTg2LjgyODEgTDEyOC4xNiwxODYuOTg4MiBMMTI2LjI5MTQsMTg1LjExOTUgTDEyNC40NDE0LDE4My4yNjk1IEwxMjEuNTQ2NywxODAuMzc0OCBMMTIwLjQyNjUsMTc5LjI1NDYgTDExOCwxNzYuODI4MSBMMTE4LDE3Ni4wMzc0IEwxMDguMzYzNiwxNzguMjUxNiBMOTguNzI3MywxNzUuNTA4MSBMODkuMDkwOSwxNzYuNjQ1NSBMNzkuNDU0NSwxNzguODA1NyBMNjkuODE4MiwxNzYuNjk4MiBMNjAuMTgxOCwxNzcuMTA4OSBMNTAuNTQ1NSwxNzcuNzMxMSBMNDAuOTA5MSwxNzcuOTM4MSBMMzEuMjcyNywxNzYuODE3NyBMMjEuNjM2NCwxNzcuNTk0IEwxMiwxNzYuODI4MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTExOCwxNzYuODI4MSBMMTE3LjQ5MTIsMTc2LjgyODEgTDExOC4yNTI4LDE3OC44MjgxIEwxMTguNDg3MywxODAuODI4MSBMMTE4LjM5NTEsMTgyLjgyODEgTDExOC41NDQ5LDE4NC44MjgxIEwxMTgsMTg2LjgyODEgTDExOCwxODYuMzk4NyBMMTIwLDE4Ni4yNDg0IEwxMjIsMTg2LjI3NTggTDEyNCwxODYuNzc1OCBMMTI2LDE4Ni42NTM0IEwxMjgsMTg2LjgyODEgTDEyOC40MjgzLDE4Ny4yNTY0IEwxMjUuODkwMiwxODQuNzE4MyBMMTIzLjc4NDQsMTgyLjYxMjUgTDEyMi4xNDM1LDE4MC45NzE2IEwxMTkuNTgwOSwxNzguNDA5IEwxMTgsMTc2LjgyODEiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk1LjI5MSIgeD0iMTgiIHk9IjE5My44OTUiPlN0b3JlU3RvcmUmIzIzNjMxOyYjMzg1NTY7PC90ZXh0PjxwYXRoIGQ9Ik04LDIxMS45NjA5IEw4LjE4NjgsMjExLjk2MDkgTDcuNjMxNywyMTYuOTYwOSBMOC4xNzE4LDIyMS45NjA5IEw4LjM1NTMsMjI2Ljk2MDkgTDcuMzY1OSwyMzEuOTYwOSBMOCwyMzYuOTYwOSBMOCwyMzYuNzUzNyBMMTcuNjE1NCwyMzUuODIzNiBMMjcuMjMwOCwyMzUuOTM4MyBMMzYuODQ2MiwyMzYuNzc5MiBMNDYuNDYxNSwyMzUuMTE3MyBMNTYuMDc2OSwyMzguNDM3MyBMNjUuNjkyMywyMzUuMjgwMiBMNzUuMzA3NywyMzYuNDMzNiBMODQuOTIzMSwyMzguMTEyOCBMOTQuNTM4NSwyMzYuNzMyMiBMMTA0LjE1MzgsMjM3LjE0MjkgTDExMy43NjkyLDIzNi44NzU3IEwxMjMuMzg0NiwyMzcuNDM3IEwxMzMsMjM2Ljk2MDkgTDEzMy4yMTI2LDIzNi45NjA5IEwxMzMuNTIwNiwyMzMuOTYwOSBMMTMzLjU5NjUsMjMwLjk2MDkgTDEzMy42MDM4LDIyNy45NjA5IEwxMzMuMjI2MywyMjQuOTYwOSBMMTMzLDIyMS45NjA5IEwxMzMuMjkxNCwyMjIuMjUyMyBMMTMxLjQ0MTQsMjIwLjQwMjMgTDEyOC41NDY3LDIxNy41MDc2IEwxMjcuNDI2NSwyMTYuMzg3NCBMMTI0LjgxMzYsMjEzLjc3NDYgTDEyMywyMTEuOTYwOSBMMTIzLDIxMy4zODQ0IEwxMTMuNDE2NywyMTAuNjQwOSBMMTAzLjgzMzMsMjExLjc3ODMgTDk0LjI1LDIxMy45Mzg2IEw4NC42NjY3LDIxMS44MzEgTDc1LjA4MzMsMjEyLjI0MTcgTDY1LjUsMjEyLjg2MzkgTDU1LjkxNjcsMjEzLjA3MDkgTDQ2LjMzMzMsMjExLjk1MDUgTDM2Ljc1LDIxMi43MjY4IEwyNy4xNjY3LDIxMC40MzQ1IEwxNy41ODMzLDIxMi43MTkzIEw4LDIxMS45NjA5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTIzLDIxMS45NjA5IEwxMjMuNDg3MywyMTEuOTYwOSBMMTIzLjM5NTEsMjEzLjk2MDkgTDEyMy41NDQ5LDIxNS45NjA5IEwxMjIuNTcwNiwyMTcuOTYwOSBMMTIyLjQyMDMsMjE5Ljk2MDkgTDEyMywyMjEuOTYwOSBMMTIzLDIyMS40MDg2IEwxMjUsMjIxLjkwODYgTDEyNywyMjEuNzg2MiBMMTI5LDIyMi41NjY2IEwxMzEsMjIxLjgwNTcgTDEzMywyMjEuOTYwOSBMMTMyLjc4NDQsMjIxLjc0NTMgTDEzMS4xNDM1LDIyMC4xMDQ0IEwxMjguNTgwOSwyMTcuNTQxOCBMMTI2LjY3MzcsMjE1LjYzNDYgTDEyNS40MDc5LDIxNC4zNjg4IEwxMjMsMjExLjk2MDkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNC4wMDAxIiB4PSIxNCIgeT0iMjI5LjAyNzgiPiYjMjY1MDA7JiMzNjg5NjsmIzIwOTg5OyYjMjU5Njg7JiMyNTE5MTsmIzM0ODkyOyYjMzI0Njc7JiMyNjQ2Mzs8L3RleHQ+PHBhdGggZD0iTTUsMjQ3LjA5MzggTDUuMTg2OCwyNDcuMDkzOCBMNC42MzE3LDI1NS4wOTM4IEw1LjE3MTgsMjYzLjA5MzggTDUuMzU1MywyNzEuMDkzOCBMNC4zNjU5LDI3OS4wOTM4IEw1LDI4Ny4wOTM4IEw1LDI4Ni44ODY1IEwxNS4wNzY5LDI4NS45NTY0IEwyNS4xNTM4LDI4Ni4wNzExIEwzNS4yMzA4LDI4Ni45MTIgTDQ1LjMwNzcsMjg1LjI1MDEgTDU1LjM4NDYsMjg4LjU3MDEgTDY1LjQ2MTUsMjg1LjQxMyBMNzUuNTM4NSwyODYuNTY2NCBMODUuNjE1NCwyODguMjQ1NiBMOTUuNjkyMywyODYuODY1IEwxMDUuNzY5MiwyODcuMjc1NyBMMTE1Ljg0NjIsMjg3LjAwODYgTDEyNS45MjMxLDI4Ny41Njk4IEwxMzYsMjg3LjA5MzggTDEzNi4yMTI2LDI4Ny4wOTM4IEwxMzYuNTIwNiwyODEuMDkzOCBMMTM2LjU5NjUsMjc1LjA5MzggTDEzNi42MDM4LDI2OS4wOTM4IEwxMzYuMjI2MywyNjMuMDkzOCBMMTM2LDI1Ny4wOTM4IEwxMzYuMjkxNCwyNTcuMzg1MSBMMTM0LjQ0MTQsMjU1LjUzNTEgTDEzMS41NDY3LDI1Mi42NDA1IEwxMzAuNDI2NSwyNTEuNTIwMiBMMTI3LjgxMzYsMjQ4LjkwNzQgTDEyNiwyNDcuMDkzOCBMMTI2LDI0OC41MTcyIEwxMTUuOTE2NywyNDUuNzczNyBMMTA1LjgzMzMsMjQ2LjkxMTEgTDk1Ljc1LDI0OS4wNzE0IEw4NS42NjY3LDI0Ni45NjM4IEw3NS41ODMzLDI0Ny4zNzQ2IEw2NS41LDI0Ny45OTY4IEw1NS40MTY3LDI0OC4yMDM3IEw0NS4zMzMzLDI0Ny4wODMzIEwzNS4yNSwyNDcuODU5NyBMMjUuMTY2NywyNDUuNTY3MyBMMTUuMDgzMywyNDcuODUyMSBMNSwyNDcuMDkzOCIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEyNiwyNDcuMDkzOCBMMTI2LjQ4NzMsMjQ3LjA5MzggTDEyNi4zOTUxLDI0OS4wOTM4IEwxMjYuNTQ0OSwyNTEuMDkzOCBMMTI1LjU3MDYsMjUzLjA5MzggTDEyNS40MjAzLDI1NS4wOTM4IEwxMjYsMjU3LjA5MzggTDEyNiwyNTYuNTQxNCBMMTI4LDI1Ny4wNDE0IEwxMzAsMjU2LjkxOTEgTDEzMiwyNTcuNjk5NCBMMTM0LDI1Ni45Mzg1IEwxMzYsMjU3LjA5MzggTDEzNS43ODQ0LDI1Ni44NzgxIEwxMzQuMTQzNSwyNTUuMjM3MiBMMTMxLjU4MDksMjUyLjY3NDYgTDEyOS42NzM3LDI1MC43Njc1IEwxMjguNDA3OSwyNDkuNTAxNiBMMTI2LDI0Ny4wOTM4IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuMDAwMSIgeD0iMTEiIHk9IjI2NC4xNjA2Ij4mIzI1MjI2OyYjMjY1MDA7JiMzNjg5NjsmIzIzNTQ1OyYjMzU5Mzc7JiMzMDM0MDsmIzI0MzQxOyYjMjk5OTI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMC44MTc1IiB4PSIxMSIgeT0iMjc5LjI5MzUiPiYjMzYxNzE7JiMyMDU0MDsmIzMyNDczOyYjMjQzNDE7JiMyOTk5MjsmIzIxNDY0OyYjMzczMjc7b2JqPC90ZXh0PjxwYXRoIGQ9Ik04NywyOTcuMzU5NCBMODcuMTg2OCwyOTcuMzU5NCBMODYuNjMxNywzMDIuMzU5NCBMODcuMTcxOCwzMDcuMzU5NCBMODcuMzU1MywzMTIuMzU5NCBMODYuMzY1OSwzMTcuMzU5NCBMODcsMzIyLjM1OTQgTDg3LDMyMi4xNTIxIEw5Ni41NDU1LDMyMS4yMjIxIEwxMDYuMDkwOSwzMjEuMzM2NyBMMTE1LjYzNjQsMzIyLjE3NzYgTDEyNS4xODE4LDMyMC41MTU3IEwxMzQuNzI3MywzMjMuODM1OCBMMTQ0LjI3MjcsMzIwLjY3ODYgTDE1My44MTgyLDMyMS44MzIgTDE2My4zNjM2LDMyMy41MTEyIEwxNzIuOTA5MSwzMjIuMTMwNiBMMTgyLjQ1NDUsMzIyLjU0MTMgTDE5MiwzMjIuMzU5NCBMMTkxLjk3MTYsMzIyLjM1OTQgTDE5Mi4xNTg3LDMxOS4zNTk0IEwxOTIuMjEyNiwzMTYuMzU5NCBMMTkyLjUyMDYsMzEzLjM1OTQgTDE5Mi41OTY1LDMxMC4zNTk0IEwxOTIsMzA3LjM1OTQgTDE5Mi40MjY5LDMwNy43ODYzIEwxOTAuMTYsMzA1LjUxOTQgTDE4OC4yOTE0LDMwMy42NTA4IEwxODYuNDQxNCwzMDEuODAwOCBMMTgzLjU0NjcsMjk4LjkwNjEgTDE4MiwyOTcuMzU5NCBMMTgyLDI5OS4xNjg3IEwxNzIuNSwyOTYuNTY4NyBMMTYzLDI5OC43ODI5IEwxNTMuNSwyOTYuMDM5MyBMMTQ0LDI5Ny4xNzY3IEwxMzQuNSwyOTkuMzM3IEwxMjUsMjk3LjIyOTQgTDExNS41LDI5Ny42NDAyIEwxMDYsMjk4LjI2MjQgTDk2LjUsMjk4LjQ2OTMgTDg3LDI5Ny4zNTk0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTgyLDI5Ny4zNTk0IEwxODEuOTk2NSwyOTcuMzU5NCBMMTgyLjI1NTMsMjk5LjM1OTQgTDE4MS40OTEyLDMwMS4zNTk0IEwxODIuMjUyOCwzMDMuMzU5NCBMMTgyLjQ4NzMsMzA1LjM1OTQgTDE4MiwzMDcuMzU5NCBMMTgyLDMwNy43NTQ1IEwxODQsMzA3LjkwNDMgTDE4NiwzMDYuOTMgTDE4OCwzMDYuNzc5NyBMMTkwLDMwNi44MDcgTDE5MiwzMDcuMzU5NCBMMTkxLjk2MywzMDcuMzIyNCBMMTg5Ljg3NjUsMzA1LjIzNTggTDE4OC40MjgzLDMwMy43ODc3IEwxODUuODkwMiwzMDEuMjQ5NiBMMTgzLjc4NDQsMjk5LjE0MzggTDE4MiwyOTcuMzU5NCIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQuODE3NSIgeD0iOTMiIHk9IjMxNC40MjYzIj4mIzM1ODM1OyYjMjM1NDU7JiMzNTkzNzsmIzI0MzQxOyYjMjk5OTI7b2JqPC90ZXh0PjxwYXRoIGQ9Ik04MiwzMzIuNDkyMiBMODIuMTg2OCwzMzIuNDkyMiBMODEuNjMxNywzMzcuNDkyMiBMODIuMTcxOCwzNDIuNDkyMiBMODIuMzU1MywzNDcuNDkyMiBMODEuMzY1OSwzNTIuNDkyMiBMODIsMzU3LjQ5MjIgTDgyLDM1Ny4yODUgTDkxLjU4MzMsMzU2LjM1NDkgTDEwMS4xNjY3LDM1Ni40Njk1IEwxMTAuNzUsMzU3LjMxMDQgTDEyMC4zMzMzLDM1NS42NDg1IEwxMjkuOTE2NywzNTguOTY4NiBMMTM5LjUsMzU1LjgxMTQgTDE0OS4wODMzLDM1Ni45NjQ4IEwxNTguNjY2NywzNTguNjQ0IEwxNjguMjUsMzU3LjI2MzQgTDE3Ny44MzMzLDM1Ny42NzQyIEwxODcuNDE2NywzNTcuNDA3IEwxOTcsMzU3LjQ5MjIgTDE5Ny4xNTg3LDM1Ny40OTIyIEwxOTcuMjEyNiwzNTQuNDkyMiBMMTk3LjUyMDYsMzUxLjQ5MjIgTDE5Ny41OTY1LDM0OC40OTIyIEwxOTcuNjAzOCwzNDUuNDkyMiBMMTk3LDM0Mi40OTIyIEwxOTcuMTYsMzQyLjY1MjIgTDE5NS4yOTE0LDM0MC43ODM2IEwxOTMuNDQxNCwzMzguOTMzNiBMMTkwLjU0NjcsMzM2LjAzODkgTDE4OS40MjY1LDMzNC45MTg3IEwxODcsMzMyLjQ5MjIgTDE4NywzMzEuNzAxNSBMMTc3LjQ1NDUsMzMzLjkxNTcgTDE2Ny45MDkxLDMzMS4xNzIxIEwxNTguMzYzNiwzMzIuMzA5NSBMMTQ4LjgxODIsMzM0LjQ2OTggTDEzOS4yNzI3LDMzMi4zNjIyIEwxMjkuNzI3MywzMzIuNzczIEwxMjAuMTgxOCwzMzMuMzk1MiBMMTEwLjYzNjQsMzMzLjYwMjEgTDEwMS4wOTA5LDMzMi40ODE4IEw5MS41NDU1LDMzMy4yNTgxIEw4MiwzMzIuNDkyMiIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTE4NywzMzIuNDkyMiBMMTg2LjQ5MTIsMzMyLjQ5MjIgTDE4Ny4yNTI4LDMzNC40OTIyIEwxODcuNDg3MywzMzYuNDkyMiBMMTg3LjM5NTEsMzM4LjQ5MjIgTDE4Ny41NDQ5LDM0MC40OTIyIEwxODcsMzQyLjQ5MjIgTDE4NywzNDIuMDYyOCBMMTg5LDM0MS45MTI1IEwxOTEsMzQxLjkzOTggTDE5MywzNDIuNDM5OCBMMTk1LDM0Mi4zMTc1IEwxOTcsMzQyLjQ5MjIgTDE5Ny40MjgzLDM0Mi45MjA1IEwxOTQuODkwMiwzNDAuMzgyNCBMMTkyLjc4NDQsMzM4LjI3NjYgTDE5MS4xNDM1LDMzNi42MzU3IEwxODguNTgwOSwzMzQuMDczMSBMMTg3LDMzMi40OTIyIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NC42MTE5IiB4PSI4OCIgeT0iMzQ5LjU1OTEiPiYjMzU4MzU7JiMyMzU0NTsmIzM1OTM3OyYjMzAzNDA7JiMyNjIyMjsmIzM2ODkwOyYjMjI0OTU7aTwvdGV4dD48cGF0aCBkPSJNODEsMzY3LjYyNSBMODEuMTg2OCwzNjcuNjI1IEw4MC42MzE3LDM3Mi42MjUgTDgxLjE3MTgsMzc3LjYyNSBMODEuMzU1MywzODIuNjI1IEw4MC4zNjU5LDM4Ny42MjUgTDgxLDM5Mi42MjUgTDgxLDM5Mi40MTc4IEw5MC43NSwzOTEuNDg3NyBMMTAwLjUsMzkxLjYwMjMgTDExMC4yNSwzOTIuNDQzMiBMMTIwLDM5MC43ODEzIEwxMjkuNzUsMzk0LjEwMTQgTDEzOS41LDM5MC45NDQzIEwxNDkuMjUsMzkyLjA5NzYgTDE1OSwzOTMuNzc2OSBMMTY4Ljc1LDM5Mi4zOTYzIEwxNzguNSwzOTIuODA3IEwxODguMjUsMzkyLjUzOTggTDE5OCwzOTIuNjI1IEwxOTguMTU4NywzOTIuNjI1IEwxOTguMjEyNiwzODkuNjI1IEwxOTguNTIwNiwzODYuNjI1IEwxOTguNTk2NSwzODMuNjI1IEwxOTguNjAzOCwzODAuNjI1IEwxOTgsMzc3LjYyNSBMMTk4LjE2LDM3Ny43ODUgTDE5Ni4yOTE0LDM3NS45MTY0IEwxOTQuNDQxNCwzNzQuMDY2NCBMMTkxLjU0NjcsMzcxLjE3MTcgTDE5MC40MjY1LDM3MC4wNTE1IEwxODgsMzY3LjYyNSBMMTg4LDM2Ni44MzQzIEwxNzguMjcyNywzNjkuMDQ4NSBMMTY4LjU0NTUsMzY2LjMwNDkgTDE1OC44MTgyLDM2Ny40NDIzIEwxNDkuMDkwOSwzNjkuNjAyNiBMMTM5LjM2MzYsMzY3LjQ5NSBMMTI5LjYzNjQsMzY3LjkwNTggTDExOS45MDkxLDM2OC41MjggTDExMC4xODE4LDM2OC43MzUgTDEwMC40NTQ1LDM2Ny42MTQ2IEw5MC43MjczLDM2OC4zOTA5IEw4MSwzNjcuNjI1IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTg4LDM2Ny42MjUgTDE4Ny40OTEyLDM2Ny42MjUgTDE4OC4yNTI4LDM2OS42MjUgTDE4OC40ODczLDM3MS42MjUgTDE4OC4zOTUxLDM3My42MjUgTDE4OC41NDQ5LDM3NS42MjUgTDE4OCwzNzcuNjI1IEwxODgsMzc3LjE5NTYgTDE5MCwzNzcuMDQ1MyBMMTkyLDM3Ny4wNzI2IEwxOTQsMzc3LjU3MjcgTDE5NiwzNzcuNDUwMyBMMTk4LDM3Ny42MjUgTDE5OC40MjgzLDM3OC4wNTMzIEwxOTUuODkwMiwzNzUuNTE1MiBMMTkzLjc4NDQsMzczLjQwOTQgTDE5Mi4xNDM1LDM3MS43Njg1IEwxODkuNTgwOSwzNjkuMjA1OSBMMTg4LDM2Ny42MjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk2LjYxNzgiIHg9Ijg3IiB5PSIzODQuNjkxOSI+JiMzNTgzNTsmIzIzNTQ1OyYjMzU5Mzc7JiMzMDM0MDtmaW5hbCYjMjI0OTU7ajwvdGV4dD48cGF0aCBkPSJNMjcsNDAyLjc1NzggTDI3LjE4NjgsNDAyLjc1NzggTDI2LjYzMTcsNDEwLjc1NzggTDI3LjE3MTgsNDE4Ljc1NzggTDI3LjM1NTMsNDI2Ljc1NzggTDI2LjM2NTksNDM0Ljc1NzggTDI3LDQ0Mi43NTc4IEwyNyw0NDIuNTUwNiBMMzYuNTU1Niw0NDEuNjIwNSBMNDYuMTExMSw0NDEuNzM1MSBMNTUuNjY2Nyw0NDIuNTc2MSBMNjUuMjIyMiw0NDAuOTE0MiBMNzQuNzc3OCw0NDQuMjM0MiBMODQuMzMzMyw0NDEuMDc3MSBMOTMuODg4OSw0NDIuMjMwNCBMMTAzLjQ0NDQsNDQzLjkwOTcgTDExMyw0NDIuNzU3OCBMMTEyLjkyMzgsNDQyLjc1NzggTDExMy4wNjA3LDQzNi43NTc4IEwxMTIuOTcxNiw0MzAuNzU3OCBMMTEzLjE1ODcsNDI0Ljc1NzggTDExMy4yMTI2LDQxOC43NTc4IEwxMTMsNDEyLjc1NzggTDExMy4zNjgxLDQxMy4xMjU5IEwxMTEuNDIxOCw0MTEuMTc5NiBMMTA5LjQyNjksNDA5LjE4NDggTDEwNy4xNiw0MDYuOTE3OSBMMTA1LjI5MTQsNDA1LjA0OTIgTDEwMyw0MDIuNzU3OCBMMTAzLDQwNC42MzA0IEw5My41LDQwMC44MzQ3IEw4NCw0MDQuNTY3MiBMNzQuNSw0MDEuOTY3MSBMNjUsNDA0LjE4MTMgTDU1LjUsNDAxLjQzNzggTDQ2LDQwMi41NzUxIEwzNi41LDQwNC43MzU0IEwyNyw0MDIuNzU3OCIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEwMyw0MDIuNzU3OCBMMTAyLjk1NjcsNDAyLjc1NzggTDEwMy4wOTM2LDQwNC43NTc4IEwxMDMuMzAxLDQwNi43NTc4IEwxMDMuMzcsNDA4Ljc1NzggTDEwMi45OTY1LDQxMC43NTc4IEwxMDMsNDEyLjc1NzggTDEwMyw0MTMuMDEzMSBMMTA1LDQxMi4yNDkgTDEwNyw0MTMuMDEwNiBMMTA5LDQxMy4yNDUxIEwxMTEsNDEzLjE1MyBMMTEzLDQxMi43NTc4IEwxMTMuMzg1Myw0MTMuMTQzMSBMMTEwLjY5NjQsNDEwLjQ1NDIgTDEwOC41OTAxLDQwOC4zNDc5IEwxMDYuNjA5NCw0MDYuMzY3MiBMMTA0Ljk2Myw0MDQuNzIwOCBMMTAzLDQwMi43NTc4IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS4wMDAxIiB4PSIzMyIgeT0iNDE5LjgyNDciPiYjMjA4ODk7JiMyNjIyMjsmIzM2ODkwOyYjMjI0OTU7JiM2NTMwNjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzEuMDQiIHg9IjMzIiB5PSI0MzQuOTU3NSI+aSA9IDE8L3RleHQ+PCEtLVNSQz1bWFAzRElpRDA1OE5Ob0xDQy0wSXc0R0tOSVRFMjgyOXF3c1FRTmROd0NuRWQ0LWlGR1hUNXFHZlRRQzQ2alJnb0F3aUI1emc4SnBEOWtsOEwzNHNqak9icUN1anhsWmRkdGJDZjRjZlhaaWllWHl0WURjU3NwUVRPWU40cWJxd2RUSUViTGlSNDNnUnZBWVQyMDRNMnN3MUVRMU5Pak82UVc4dktIVUVTTElDSjB5M0E1V19xS2FXaGNZYU9ybmRGMHF6R3J5V01oMTRBYXEza2hwQXplUlBhZjhvQ2dnWkExa1EyY0NKMkxGbVJDQ2JDRUhhaWxtcXlYY0tPNVVrdTM2WXJSNjVKbkJHaUVHR3FsbllSbnpRQkJmeUFuUmlzN2FjX2QtQTVfR2FRSnVQaFFUWTJWVkxPTk1TMjREaTNabHB0SnhfUnE5UXprX2dXVFl6RkZ4cE1pdEhoeWg3WGRKcTYzblM5ZzNuZlJuNkFJeEJKLU5BVEpMZjBBc1dYV1NrNm9KMXl2NGpwdURwQ0k4dG9fRndiVHpqOUdpX0ZIdEpsQk5Ydnk5c3dUNWwtTE5VSjFneURNTkZ6VlppUW9FUnJ1Qko5U2VNT1lSdVN6RmhIem1ZVDBPS1BObGpmSzdGMkl5YUN5QVVIR2Q5WE92elhPb0hpUkZ1Ul0tLT48L2c+PC9zdmc+'>
<ul>
<li>上图中，写普通域的操作被编译器重排到了构造函数之外，读线程B错误地读取了普通变量i初始化之前的值</li>
<li>而写final域的操作，被写final域的重排序规则&quot;限定&quot;在了构造函数之内，读线程B正确地读取了final变量初始化之后的值</li>
<li>如果允许final域的写重排到构造函数之外，那么其他线程将可能访问到一个尚未初始化的final域(此时构造函数已经return，但是对象尚未构造完成)，<strong>这也就是单例模式中双重检测机制为什么存在问题的原因</strong></li>
<li>写final域的重排序规则可以保证：在对象引用为任意线程可见之前，对象的final域已经被正确初始化过了，而普通域不具有这个保障</li>
</ul>
<h2 id="22-读final域的重排序规则"><a class="markdownIt-Anchor" href="#22-读final域的重排序规则"></a> 2.2 读final域的重排序规则</h2>
<p>读final域的重排序规则是，在一个线程中，初次读取对象引用与初次读取该对象包含的final域，JMM禁止处理器重排序这两个操作(注意，这个规则仅仅针对处理器)。编译器会在读final域操作的前面插入一个LoadLoad屏障</p>
<p>初次读对象引用与初次读该对象包含的final域，<strong>这两个操作之间存在间接依赖关系</strong></p>
<ul>
<li>由于编译器遵守间接依赖关系，因此不会重排序这两个操作</li>
<li>大多数处理器也会遵守间接依赖，也不会重排序这两个操作。但有少数处理器允许对存在间接依赖关系的操作做重排序(比如alpha处理器),<strong>这个规则就是专门用来针对这种处理器的</strong></li>
</ul>
<p>reader()方法包含3个操作</p>
<ul>
<li>初次读引用变量obj</li>
<li>初次读引用变量obj指向对象的普通域i</li>
<li>初次读引用变量obj指向对象的final域j</li>
</ul>
<p>假设写线程A没有发生任何重排序，同时程序在<strong>不遵守</strong>间接依赖的处理器上执行，那么下图就是一种可能的执行顺序</p>
<ul>
<li><strong>注意</strong>，编译器是不允许这种重排的，但是某些处理器允许</li>
</ul>
<img src='data:image/svg+xml;base64,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'>
<ul>
<li>在上图中，读对象的普通域的操作被处理器重排序到读对象引用之前。读普通域时，该域还没有被线程A写入，这是一个错误地读取操作</li>
<li>而读final域的重排序规则会把读对象final域的操作&quot;限定&quot;在读对象引用之后，此时该final域已经被A线程初始化过了，这是一个正确地读取操作</li>
<li>读final域的重排序规则可以确保：在读一个对象的final域之前，一定会先读包含这个fianl域的对象的引用</li>
</ul>
<h1 id="3-final域为引用类型"><a class="markdownIt-Anchor" href="#3-final域为引用类型"></a> 3 final域为引用类型</h1>
<p>对于引用类型，写final域的重排序规则对编译器和处理器增加了如下约束</p>
<ul>
<li>在构造函数内对一个final引用的对象的成员的写入，与随后在构造函数外把这个被构造对象的引用赋值给一个引用变量，这两个操作之间不能重排序</li>
<li>确保在final引用的初始化在构造函数内完成，因此一旦其他线程拿到了一个非null的final引用，那么这个引用一定是在构造函数内被正确赋值的(至于是否正确初始化，则不一定，这取决于final引用的赋值语句)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalReferenceExample</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span>[] intArray;<span class="comment">//final是引用类型</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> FinalReferenceExample obj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FinalReferenceExample</span><span class="params">()</span> &#123;<span class="comment">//构造函数</span></span><br><span class="line">        intArray = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1</span>];<span class="comment">//1</span></span><br><span class="line">        intArray[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writerOne</span><span class="params">()</span> &#123;<span class="comment">//写线程A执行</span></span><br><span class="line">        obj = <span class="keyword">new</span> <span class="title class_">FinalReferenceExample</span>();<span class="comment">//3</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writerTwo</span><span class="params">()</span> &#123;<span class="comment">//写线程B执行</span></span><br><span class="line">        obj.intArray[<span class="number">0</span>] = <span class="number">2</span>;<span class="comment">//4</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reader</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">temp1</span> <span class="operator">=</span> obj.intArray[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>假设首先线程A执行writerOne()方法，执行完后线程B执行writerTwo()方法，执行完后线程C执行reader()方法，下图是一种可能的执行时序</p>
<img src='data:image/svg+xml;base64,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'>
<ul>
<li>1和3不能重排序，2和3也不能重排序</li>
<li>JMM可以确保读线程C至少能看到写线程A在构造函数中对final引用对象的成员域的写入，即C至少能看到数组下标0的值为1</li>
<li>而写线程B对数组元素的写入，读线程C可能看得到，也可能看不到。JMM不保证线程B的写入对读线程C可见，因为写线程B和读线程C之间存在数据竞争，此时执行结果不可预知</li>
<li>如果想要确保读线程C看到写线程B对数组元素的写入，写线程B和读线程C之间需要使用同步原语(lock或volatile)来保证内存可见性</li>
</ul>
<h1 id="4-为什么final引用不能从构造函数中逸出"><a class="markdownIt-Anchor" href="#4-为什么final引用不能从构造函数中逸出"></a> 4 为什么final引用不能从构造函数中逸出</h1>
<p>写final域的重排序规则可以确保：在引用变量为任意线程可见之前，该引用变量指向的对象的final域已经在构造函数中被正确初始化过了</p>
<ul>
<li>其实，要得到这个效果，还需要一个保证：在构造函数内部，不能让这个被构造对象的引用为其他线程所见，也就是对象引用不能再构造函数中&quot;逸出&quot;</li>
<li>否则，其他线程可能在构造过程中访问到一个尚未初始化完毕的对象的final域</li>
<li>看下面的例子</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalReferenceEscapeExample</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">static</span> FinalReferenceEscapeExample obj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FinalReferenceEscapeExample</span><span class="params">()</span> &#123;</span><br><span class="line">        i = <span class="number">1</span>;<span class="comment">//1 写final域</span></span><br><span class="line">        obj = <span class="built_in">this</span>;<span class="comment">//2 this引用在此&quot;逸出&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">FinalReferenceEscapeExample</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reader</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;<span class="comment">//3</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> obj.i;<span class="comment">//4</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>假设一个线程A执行writer()方法，另一个线程B执行reader()方法，下图是一种可能的执行时序</p>
<img src='data:image/svg+xml;base64,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'>
<ul>
<li>这里操作2使得对象还未完成构造前就为线程B可见。即使这里的操作2是构造函数的最后一步，且在程序中操作2排在操作1后面，执行read()方法的线程仍然可能无法看到final域被初始化后的值，因为操作1和操作2之间可能被重排序(final域的重排规则仅仅保证了final域的写必须在构造方法返回前完成，但是并没有规定构造函数中final域的写与其他语句不能重排序)</li>
<li>在构造函数返回之前，被构造对象的引用不能为其他线程所见，因为此时的final域可能还没有被初始化。在构造函数返回后，任意线程都将保证能看到final域正确初始化之后的值</li>
</ul>
<h1 id="5-final语义在处理器中的实现"><a class="markdownIt-Anchor" href="#5-final语义在处理器中的实现"></a> 5 final语义在处理器中的实现</h1>
<p>上面提到</p>
<ul>
<li>写final域的重排序规则会要求编译器在final域的写之后，构造函数return之前插入一个StoreStore屏障</li>
<li>读final域的重排序规则会要求编译器在读final域的操作前面插入一个LoadLoad屏障</li>
</ul>
<p>由于X86处理器不会对写-写操作做重排序，所以在X86处理器中，写final域需要的StoreStore屏障会被省略掉。同样X86处理器不会对存在间接依赖关系的操作做重排序，所以在X86处理器中，读final域需要的LoadLoad屏障也会被省略掉，也就是说，在X86处理器中，final域的读写不会插入任何的内存屏障</p>
<h1 id="6-jsr-133为什么要增强final的语义"><a class="markdownIt-Anchor" href="#6-jsr-133为什么要增强final的语义"></a> 6 JSR-133为什么要增强final的语义</h1>
<p>在旧的Java内存模型中，一个最严重的缺陷就是线程可以看到final域的值会改变。比如，一个线程当前看到一个整型final域的值为0(还未初始化之前的默认值)，过一段时间之后这个线程再去读这个final域的值时，却发现值变为1(被某个线程初始化之后的值)。最常见的例子就是在旧的Java内存模型中，String的值可能会改变</p>
<p>为了修补这个漏洞，JSR-133专家组增强了final的语义。通过为final域增加写和读重排序规则，可以为Java程序员提供初始化安全保证：<strong>只要对象时正确构造的(被构造对象的引用在构造函数中没有&quot;逸出&quot;)，那么不需要使用同步(指lock和volatile的使用)就可以保证任意线程都能看到这个final域在构造函数中被初始化之后的值</strong></p>
<ul>
<li>要看到域，前提是必须获取该对象的引用。而获取到引用的时候，这个final域必定已经正确初始化，因此是安全的</li>
</ul>
<h1 id="7-参考"><a class="markdownIt-Anchor" href="#7-参考"></a> 7 参考</h1>
<ul>
<li>《Java并发编程的艺术》</li>
</ul>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%91%98%E5%BD%95/" rel="tag"># 摘录</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/07/08/Java-%E9%94%81%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89/" rel="prev" title="Java-锁的内存语义">
      <i class="fa fa-chevron-left"></i> Java-锁的内存语义
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/07/08/Java-happens-before/" rel="next" title="Java-happens-before">
      Java-happens-before <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-livere">livere</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane livere" id="comment-livere">
              
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zMzY0My8xMDE5OA=="></div>
  </div>
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E5%89%8D%E8%A8%80"><span class="nav-text"> 1 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-final%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"><span class="nav-text"> 2 final域的重排序规则</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#21-%E5%86%99final%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"><span class="nav-text"> 2.1 写final域的重排序规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-%E8%AF%BBfinal%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"><span class="nav-text"> 2.2 读final域的重排序规则</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-final%E5%9F%9F%E4%B8%BA%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B"><span class="nav-text"> 3 final域为引用类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-%E4%B8%BA%E4%BB%80%E4%B9%88final%E5%BC%95%E7%94%A8%E4%B8%8D%E8%83%BD%E4%BB%8E%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%AD%E9%80%B8%E5%87%BA"><span class="nav-text"> 4 为什么final引用不能从构造函数中逸出</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-final%E8%AF%AD%E4%B9%89%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text"> 5 final语义在处理器中的实现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-jsr-133%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%A2%9E%E5%BC%BAfinal%E7%9A%84%E8%AF%AD%E4%B9%89"><span class="nav-text"> 6 JSR-133为什么要增强final的语义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-%E5%8F%82%E8%80%83"><span class="nav-text"> 7 参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Liuyehcf"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Liuyehcf</p>
  <div class="site-description" itemprop="description">大音希声，大象无形</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">285</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">99</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liuyehcf</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qhEhLuMeMOy1zgcBhkqUS6P8-gzGzoHsz',
      appKey     : 'uhkruDLNLNdL5rQjRBY2X9Ke',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
