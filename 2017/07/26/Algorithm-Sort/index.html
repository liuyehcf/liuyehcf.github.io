<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="阅读更多">
<meta property="og:type" content="article">
<meta property="og:title" content="Algorithm-Sort">
<meta property="og:url" content="http://example.com/2017/07/26/Algorithm-Sort/index.html">
<meta property="og:site_name" content="Liuye Notebook">
<meta property="og:description" content="阅读更多">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-07-26T13:10:17.000Z">
<meta property="article:modified_time" content="2024-03-18T13:37:51.000Z">
<meta property="article:author" content="Liuyehcf">
<meta property="article:tag" content="原创">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2017/07/26/Algorithm-Sort/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Algorithm-Sort | Liuye Notebook</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Liuye Notebook</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-explore">

    <a href="/explore/" rel="section"><i class="fa fa-sitemap fa-fw"></i>发现</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/07/26/Algorithm-Sort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Liuyehcf">
      <meta itemprop="description" content="大音希声，大象无形">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liuye Notebook">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Algorithm-Sort
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-26 21:10:17" itemprop="dateCreated datePublished" datetime="2017-07-26T21:10:17+08:00">2017-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-18 21:37:51" itemprop="dateModified" datetime="2024-03-18T21:37:51+08:00">2024-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/Sort/" itemprop="url" rel="index"><span itemprop="name">Sort</span></a>
                </span>
            </span>

          
            <span id="/2017/07/26/Algorithm-Sort/" class="post-meta-item leancloud_visitors" data-flag-title="Algorithm-Sort" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/07/26/Algorithm-Sort/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/07/26/Algorithm-Sort/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>阅读更多</strong></p>
<span id="more"></span>
<h1 id="1-bubble-sort"><a class="markdownIt-Anchor" href="#1-bubble-sort"></a> 1 Bubble Sort</h1>
<p>冒泡排序，每次从底部(数组末尾)往上(数组有效左边界，该左边界会递增)找到最小值，并置于左边界上，再递增左边界。很简单，直接上代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.liuyehcf.sort.bubblesort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.liuyehcf.sort.SortUtils.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by HCF on 2017/7/26.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BubbleSort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> nums.length - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                compareAndExchange(nums, j - <span class="number">1</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">compareAndExchange</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[left] &gt; nums[right]) &#123;</span><br><span class="line">            exchange(nums, left, right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-insertion-sort"><a class="markdownIt-Anchor" href="#2-insertion-sort"></a> 2 Insertion Sort</h1>
<h2 id="21-经典版本"><a class="markdownIt-Anchor" href="#21-经典版本"></a> 2.1 经典版本</h2>
<p>循环不变式：<code>nums[0]~nums[i-1]为有序片段</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by HCF on 2017/7/26.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InsertSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[i];</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; nums[j] &gt; pivot) &#123;</span><br><span class="line">                nums[j + <span class="number">1</span>] = nums[j];</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            nums[j + <span class="number">1</span>] = pivot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="22-二分插入排序"><a class="markdownIt-Anchor" href="#22-二分插入排序"></a> 2.2 二分插入排序</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BinaryInsertSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[i];</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>, right = i - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//首先检查两种特殊情况</span></span><br><span class="line">            <span class="keyword">if</span> (nums[right] &lt;= pivot) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[<span class="number">0</span>] &gt; pivot) &#123;</span><br><span class="line">                System.arraycopy(nums, <span class="number">0</span>, nums, <span class="number">1</span>, i);</span><br><span class="line">                nums[<span class="number">0</span>] = pivot;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + (right - left &gt;&gt; <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (nums[mid] &lt;= pivot) &#123;</span><br><span class="line">                    left = mid + <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    right = mid;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.arraycopy(nums, left, nums, left + <span class="number">1</span>, i - left);</span><br><span class="line">            nums[left] = pivot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-merge-sort"><a class="markdownIt-Anchor" href="#3-merge-sort"></a> 3 Merge Sort</h1>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergeSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sort(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + (right - left &gt;&gt; <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//注意这里不能变为[left,mid-1]与[mid,right]</span></span><br><span class="line">            sort(nums, left, mid);</span><br><span class="line"></span><br><span class="line">            sort(nums, mid + <span class="number">1</span>, right);</span><br><span class="line"></span><br><span class="line">            merge(nums, left, mid, mid + <span class="number">1</span>, right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left1, <span class="type">int</span> right1, <span class="type">int</span> left2, <span class="type">int</span> right2)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] tmp = <span class="keyword">new</span> <span class="title class_">int</span>[right1 - left1 + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        System.arraycopy(nums, left1, tmp, <span class="number">0</span>, tmp.length);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">i1</span> <span class="operator">=</span> <span class="number">0</span>, i2 = left2, i = left1;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i1 &lt;= tmp.length - <span class="number">1</span> &amp;&amp; i2 &lt;= right2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp[i1] &lt;= nums[i2]) &#123;</span><br><span class="line">                nums[i++] = tmp[i1++];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                nums[i++] = nums[i2++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i1 &lt;= tmp.length - <span class="number">1</span>) &#123;</span><br><span class="line">            System.arraycopy(tmp, i1, nums, i, tmp.length - i1);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i2 &lt;= right2) &#123;</span><br><span class="line">            System.arraycopy(nums, i2, nums, i, right2 - i2 + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>归并排序还有一个优化版本TimSort，关于TimSort的实现可以参考JDK Arrays.sort的源码 <a href="/2017/07/24/SourceAnalysis-ComparableTimSort/" title="SourceAnalysis-ComparableTimSort">SourceAnalysis-ComparableTimSort</a></p>
<h2 id="31-paralle-merge"><a class="markdownIt-Anchor" href="#31-paralle-merge"></a> 3.1 Paralle Merge</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParallelMerger</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(std::vector&lt;<span class="type">int32_t</span>&gt;&amp; A, std::vector&lt;<span class="type">int32_t</span>&gt;&amp; B, std::vector&lt;<span class="type">int32_t</span>&gt;&amp; S, <span class="type">int32_t</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="type">int32_t</span> length = (A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>()) / p + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= p; ++i) &#123;</span><br><span class="line">            <span class="keyword">auto</span> pair = <span class="built_in">diagnoal_intersection</span>(A, B, i, p);</span><br><span class="line">            <span class="type">int32_t</span> a_start = pair.first;</span><br><span class="line">            <span class="type">int32_t</span> b_start = pair.second;</span><br><span class="line">            <span class="type">int32_t</span> s_start = i * (A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>()) / p;</span><br><span class="line">            <span class="built_in">do_merge_along_path</span>(A, a_start, B, b_start, S, s_start, length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function">std::pair&lt;<span class="type">int32_t</span>, <span class="type">int32_t</span>&gt; <span class="title">diagnoal_intersection</span><span class="params">(std::vector&lt;<span class="type">int32_t</span>&gt;&amp; A, std::vector&lt;<span class="type">int32_t</span>&gt;&amp; B, <span class="type">int32_t</span> p_i,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                      <span class="type">int32_t</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="type">int32_t</span> diag = p_i * (A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>()) / p;</span><br><span class="line">        <span class="keyword">if</span> (diag &gt; A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>() - <span class="number">1</span>) &#123;</span><br><span class="line">            diag = A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int32_t</span> i_high = diag;</span><br><span class="line">        <span class="type">int32_t</span> i_low = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (i_high &gt; A.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            i_high = A.<span class="built_in">size</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// binary search</span></span><br><span class="line">        <span class="keyword">while</span> (i_low &lt; i_high) &#123;</span><br><span class="line">            <span class="type">int32_t</span> i = i_low + (i_high - i_low) / <span class="number">2</span>;</span><br><span class="line">            <span class="type">int32_t</span> j = diag - i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">auto</span> pair = <span class="built_in">is_intersection</span>(A, i, B, j);</span><br><span class="line">            <span class="type">bool</span> is_intersection = pair.first;</span><br><span class="line">            <span class="type">bool</span> all_true = pair.second;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (is_intersection) &#123;</span><br><span class="line">                <span class="keyword">return</span> std::<span class="built_in">make_pair</span>(i, j);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (all_true) &#123;</span><br><span class="line">                i_high = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                i_low = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// edge cases</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> offset = <span class="number">0</span>; offset &lt;= <span class="number">1</span>; offset++) &#123;</span><br><span class="line">            <span class="type">int32_t</span> i = i_low + offset;</span><br><span class="line">            <span class="type">int32_t</span> j = diag - i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">auto</span> pair = <span class="built_in">is_intersection</span>(A, i, B, j);</span><br><span class="line">            <span class="type">bool</span> is_intersection = pair.first;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (is_intersection) &#123;</span><br><span class="line">                <span class="keyword">return</span> std::<span class="built_in">make_pair</span>(i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> std::<span class="built_in">logic_error</span>(<span class="string">&quot;unexpected&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::pair&lt;<span class="type">bool</span>, <span class="type">bool</span>&gt; <span class="title">is_intersection</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; A, <span class="type">const</span> <span class="type">int32_t</span> i, <span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; B,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          <span class="type">const</span> <span class="type">int32_t</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// M matrix is a matrix conprising of only boolean value</span></span><br><span class="line">        <span class="comment">// if A[i] &gt; B[j], then M[i, j] = true</span></span><br><span class="line">        <span class="comment">// if A[i] &lt;= B[j], then M[i, j] = false</span></span><br><span class="line">        <span class="comment">// and for the edge cases (i or j beyond the matrix), think about the merge path, with A as the vertical vector and B as the horizontal vector,</span></span><br><span class="line">        <span class="comment">// which goes from left top to right bottom, the positions below the merge path should be true, and otherwise should be false</span></span><br><span class="line">        <span class="keyword">auto</span> evaluator = [&amp;A, &amp;B](<span class="type">int32_t</span> i, <span class="type">int32_t</span> j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &gt;= A.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt;= B.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> A[i] &gt; B[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">bool</span> has_true = <span class="literal">false</span>;</span><br><span class="line">        <span class="type">bool</span> has_false = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">evaluator</span>(i - <span class="number">1</span>, j - <span class="number">1</span>)) &#123;</span><br><span class="line">            has_true = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            has_false = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">evaluator</span>(i - <span class="number">1</span>, j)) &#123;</span><br><span class="line">            has_true = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            has_false = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">evaluator</span>(i, j - <span class="number">1</span>)) &#123;</span><br><span class="line">            has_true = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            has_false = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">evaluator</span>(i, j)) &#123;</span><br><span class="line">            has_true = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            has_false = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> std::<span class="built_in">make_pair</span>(has_true &amp;&amp; has_false, has_true);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">do_merge_along_path</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; A, <span class="type">const</span> <span class="type">int32_t</span> a_start, <span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; B,</span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="type">const</span> <span class="type">int32_t</span> b_start, std::vector&lt;<span class="type">int32_t</span>&gt;&amp; S, <span class="type">int32_t</span> s_start, <span class="type">int32_t</span> length)</span> </span>&#123;</span><br><span class="line">        <span class="type">int32_t</span> i = a_start;</span><br><span class="line">        <span class="type">int32_t</span> j = b_start;</span><br><span class="line">        <span class="type">int32_t</span> k = s_start;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (k - s_start &lt; length &amp;&amp; k &lt; S.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= A.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                S[k] = B[j];</span><br><span class="line">                k++;</span><br><span class="line">                j++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt;= B.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                S[k] = A[i];</span><br><span class="line">                k++;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (A[i] &lt;= B[j]) &#123;</span><br><span class="line">                S[k] = A[i];</span><br><span class="line">                k++;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                S[k] = B[j];</span><br><span class="line">                k++;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int32_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i != <span class="number">0</span>) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; v[i];</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int32_t</span> max = <span class="number">100</span>;</span><br><span class="line">    std::default_random_engine e;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">int32_t</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, max)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> times = <span class="number">0</span>; times &lt; max; ++times) &#123;</span><br><span class="line">        <span class="type">int32_t</span> size_A = <span class="built_in">u</span>(e);</span><br><span class="line">        <span class="type">int32_t</span> size_B = <span class="built_in">u</span>(e);</span><br><span class="line"></span><br><span class="line">        std::vector&lt;<span class="type">int32_t</span>&gt; A;</span><br><span class="line">        std::vector&lt;<span class="type">int32_t</span>&gt; B;</span><br><span class="line">        std::vector&lt;<span class="type">int32_t</span>&gt; expected;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int32_t</span> i = <span class="number">0</span>; i &lt; size_A; ++i) &#123;</span><br><span class="line">            <span class="type">int32_t</span> item = <span class="built_in">u</span>(e);</span><br><span class="line">            A.<span class="built_in">push_back</span>(item);</span><br><span class="line">            expected.<span class="built_in">push_back</span>(item);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int32_t</span> i = <span class="number">0</span>; i &lt; size_B; ++i) &#123;</span><br><span class="line">            <span class="type">int32_t</span> item = <span class="built_in">u</span>(e);</span><br><span class="line">            B.<span class="built_in">push_back</span>(item);</span><br><span class="line">            expected.<span class="built_in">push_back</span>(item);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        std::<span class="built_in">sort</span>(A.<span class="built_in">begin</span>(), A.<span class="built_in">end</span>());</span><br><span class="line">        std::<span class="built_in">sort</span>(B.<span class="built_in">begin</span>(), B.<span class="built_in">end</span>());</span><br><span class="line">        std::<span class="built_in">sort</span>(expected.<span class="built_in">begin</span>(), expected.<span class="built_in">end</span>());</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;A&#x27;s size=&quot;</span> &lt;&lt; A.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;, B&#x27;s size=&quot;</span> &lt;&lt; B.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">1</span>; p &lt;= <span class="number">128</span>; p++) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;times=&quot;</span> &lt;&lt; times &lt;&lt; <span class="string">&quot;, p=&quot;</span> &lt;&lt; p &lt;&lt; std::endl;</span><br><span class="line">            std::vector&lt;<span class="type">int32_t</span>&gt; S;</span><br><span class="line">            S.<span class="built_in">assign</span>(A.<span class="built_in">size</span>() + B.<span class="built_in">size</span>(), <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">            ParallelMerger merger;</span><br><span class="line">            merger.<span class="built_in">merge</span>(A, B, S, p);</span><br><span class="line"></span><br><span class="line">            <span class="type">bool</span> is_ok = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int32_t</span> i = <span class="number">0</span>; i &lt; S.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (S[i] != expected[i]) &#123;</span><br><span class="line">                    is_ok = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!is_ok) &#123;</span><br><span class="line">                std::cerr &lt;&lt; <span class="string">&quot;not ok&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">                <span class="built_in">print</span>(A);</span><br><span class="line">                <span class="built_in">print</span>(B);</span><br><span class="line">                <span class="built_in">print</span>(S);</span><br><span class="line">                <span class="built_in">print</span>(expected);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-heap-sort"><a class="markdownIt-Anchor" href="#4-heap-sort"></a> 4 Heap Sort</h1>
<p>首先创建一个最大堆，然后将堆顶元素与当前边界元素交换，并将边界减少1，对堆顶元素维护性质</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeapSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        buildMaxHeap(nums);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> nums.length; len &gt;= <span class="number">2</span>; len--) &#123;</span><br><span class="line">            exchange(nums, <span class="number">0</span>, len - <span class="number">1</span>);</span><br><span class="line">            maxHeapFix(nums, len - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">maxHeapFix</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> heapSize, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> i * <span class="number">2</span> + <span class="number">1</span>, right = i * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (left &gt;= heapSize) &#123;</span><br><span class="line">            left = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (right &gt;= heapSize) &#123;</span><br><span class="line">            right = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (left != -<span class="number">1</span> &amp;&amp; nums[left] &gt; nums[i]) &#123;</span><br><span class="line">            max = left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (right != -<span class="number">1</span> &amp;&amp; nums[right] &gt; nums[max]) &#123;</span><br><span class="line">            max = right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (max != i) &#123;</span><br><span class="line">            exchange(nums, i, max);</span><br><span class="line">            maxHeapFix(nums, heapSize, max);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">buildMaxHeap</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length &gt;&gt; <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            maxHeapFix(nums, nums.length, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="41-topk"><a class="markdownIt-Anchor" href="#41-topk"></a> 4.1 TopK</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int32_t</span>&gt; <span class="title">top_k</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int32_t</span>&gt;&amp; nums, <span class="type">size_t</span> k)</span> </span>&#123;</span><br><span class="line">    std::priority_queue&lt;<span class="type">int32_t</span>, std::vector&lt;<span class="type">int32_t</span>&gt;, std::greater&lt;<span class="type">int32_t</span>&gt;&gt; min_queue;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> num : nums) &#123;</span><br><span class="line">        <span class="keyword">if</span> (min_queue.<span class="built_in">size</span>() &lt; k) &#123;</span><br><span class="line">            min_queue.<span class="built_in">push</span>(num);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num &gt; min_queue.<span class="built_in">top</span>()) &#123;</span><br><span class="line">            min_queue.<span class="built_in">pop</span>();</span><br><span class="line">            min_queue.<span class="built_in">push</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    std::list&lt;<span class="type">int32_t</span>&gt; res;</span><br><span class="line">    <span class="keyword">while</span> (!min_queue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        res.<span class="built_in">insert</span>(res.<span class="built_in">begin</span>(), min_queue.<span class="built_in">top</span>());</span><br><span class="line">        min_queue.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>()&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">size_t</span> test_times = <span class="number">100</span>;</span><br><span class="line">    std::default_random_engine e;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">size_t</span>&gt; <span class="title">u_k</span><span class="params">(<span class="number">1</span>, <span class="number">20</span>)</span></span>;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">size_t</span>&gt; <span class="title">u_size</span><span class="params">(<span class="number">1</span>, <span class="number">50</span>)</span></span>;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">int32_t</span>&gt; <span class="title">u_num</span><span class="params">(<span class="number">1</span>, <span class="number">10000</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; test_times; ++i) &#123;</span><br><span class="line">        <span class="type">const</span> <span class="type">size_t</span> k = <span class="built_in">u_k</span>(e);</span><br><span class="line">        <span class="type">const</span> <span class="type">size_t</span> size = <span class="built_in">u_size</span>(e);</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;test_time=&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="string">&quot;, size=&quot;</span> &lt;&lt; size &lt;&lt; std::endl;</span><br><span class="line">        std::vector&lt;<span class="type">int32_t</span>&gt; nums;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; size; ++j) &#123;</span><br><span class="line">            nums.<span class="built_in">push_back</span>(<span class="built_in">u_num</span>(e));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        std::vector&lt;<span class="type">int32_t</span>&gt; res = <span class="built_in">top_k</span>(nums, k);</span><br><span class="line">        std::<span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>(), std::<span class="built_in">greater</span>&lt;<span class="type">int32_t</span>&gt;());</span><br><span class="line">        <span class="keyword">if</span> (k &lt; size) &#123;</span><br><span class="line">            nums = std::<span class="built_in">vector</span>&lt;<span class="type">int32_t</span>&gt;(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">begin</span>() + k);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; res.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (res[j] != nums[j]) &#123;</span><br><span class="line">                std::cerr &lt;&lt; <span class="string">&quot;wrong result&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-quick-sort"><a class="markdownIt-Anchor" href="#5-quick-sort"></a> 5 Quick Sort</h1>
<h2 id="51-2-way-quick-sort"><a class="markdownIt-Anchor" href="#51-2-way-quick-sort"></a> 5.1 2-way Quick Sort</h2>
<p>下面给出经典快排的源码，包含递归模式和非递归模式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by HCF on 2017/4/23.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortRecursive(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortStack(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> partition(nums, lo, hi);</span><br><span class="line">            sortRecursive(nums, lo, mid - <span class="number">1</span>);</span><br><span class="line">            sortRecursive(nums, mid + <span class="number">1</span>, hi);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortStack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        LinkedList&lt;<span class="type">int</span>[]&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;lo, hi&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span>[] peek = stack.pop();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">peekLo</span> <span class="operator">=</span> peek[<span class="number">0</span>], peekHi = peek[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> partition(nums, peekLo, peekHi);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (peekLo &lt; mid - <span class="number">1</span>) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;peekLo, mid - <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (mid + <span class="number">1</span> &lt; peekHi) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;mid + <span class="number">1</span>, peekHi&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> lo - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[hi];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> lo; j &lt; hi; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &lt; pivot) &#123;</span><br><span class="line">                exchange(nums, ++i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        exchange(nums, ++i, hi);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="52-3-way-quick-sort"><a class="markdownIt-Anchor" href="#52-3-way-quick-sort"></a> 5.2 3-way Quick Sort</h2>
<p>下面直接给出3-way快排的源码，包括递归模式和非递归模式</p>
<p>partition方法中lt和gt的含义如下</p>
<ol>
<li>lt代表小于pivot的右边界</li>
<li>gt代表大于pivot的左边界</li>
<li>因此满足<code>nums[lo~lt]&lt;pivot nums[lt+1~gt-1]==pivot nums[gt~hi]&gt;pivot</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by HCF on 2017/7/25.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreeWayQuickSort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortRecursive(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortStack(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="type">int</span>[] range = partition(nums, lo, hi);</span><br><span class="line"></span><br><span class="line">            sortRecursive(nums, lo, range[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">            sortRecursive(nums, range[<span class="number">1</span>], hi);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortStack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        LinkedList&lt;<span class="type">int</span>[]&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;lo, hi&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span>[] peek = stack.pop();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">peekLo</span> <span class="operator">=</span> peek[<span class="number">0</span>], peekHi = peek[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span>[] range = partition(nums, peekLo, peekHi);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (peekLo &lt; range[<span class="number">0</span>]) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;peekLo, range[<span class="number">0</span>]&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (range[<span class="number">1</span>] &lt; peekHi) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;range[<span class="number">1</span>], peekHi&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] partition(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lt</span> <span class="operator">=</span> lo - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">gt</span> <span class="operator">=</span> hi + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[hi];</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> lo;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; gt) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &lt; pivot) &#123;</span><br><span class="line">                exchange(nums, ++lt, j++);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[j] &gt; pivot) &#123;</span><br><span class="line">                exchange(nums, --gt, j);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;lt, gt&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="53-dual-pivot-quick-sort"><a class="markdownIt-Anchor" href="#53-dual-pivot-quick-sort"></a> 5.3 Dual-Pivot Quick Sort</h2>
<p>下面直接给出双轴快排的源码，包括递归模式和非递归模式</p>
<p>其中partition方法中的lt、le、ge、lt含义如下</p>
<ol>
<li>lt代表小于pivot1的右边界</li>
<li>le代表等于pivot1的右边界</li>
<li>ge代表等于pivot2的左边界</li>
<li>gt代表大于pivot2的右边界</li>
<li>因此满足<code>nums[lo~lt]&lt;pivot1 nums[lt+1~le]==pivot2  pivot1&lt;nums[le+1~ge-1]&lt;pivot2 nums[ge~gt-1]==pivot2 nums[gt~hi]&gt;pivot2</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by HCF on 2017/7/25.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DualPivotQuickSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortRecursive(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        sortStack(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortRecursive</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="type">int</span>[] range = partition(nums, lo, hi);</span><br><span class="line">            sortRecursive(nums, lo, range[<span class="number">0</span>]);</span><br><span class="line">            sortRecursive(nums, range[<span class="number">1</span>] + <span class="number">1</span>, range[<span class="number">2</span>] - <span class="number">1</span>);</span><br><span class="line">            sortRecursive(nums, range[<span class="number">3</span>], hi);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sortStack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> &#123;</span><br><span class="line">        LinkedList&lt;<span class="type">int</span>[]&gt; stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) &#123;</span><br><span class="line">            stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;lo, hi&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span>[] peek = stack.pop();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">peekLo</span> <span class="operator">=</span> peek[<span class="number">0</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">peekHi</span> <span class="operator">=</span> peek[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span>[] range = partition(nums, peekLo, peekHi);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (peekLo &lt; range[<span class="number">0</span>]) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;peekLo, range[<span class="number">0</span>]&#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (range[<span class="number">1</span>] + <span class="number">1</span> &lt; range[<span class="number">2</span>] - <span class="number">1</span>) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;range[<span class="number">1</span>] + <span class="number">1</span>, range[<span class="number">2</span>] - <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (range[<span class="number">3</span>] &lt; peekHi) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;range[<span class="number">3</span>], peekHi&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] partition(<span class="type">int</span>[] nums, <span class="type">int</span> lo, <span class="type">int</span> hi) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lt</span> <span class="operator">=</span> lo - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">le</span> <span class="operator">=</span> lt;</span><br><span class="line">        <span class="type">int</span> <span class="variable">gt</span> <span class="operator">=</span> hi + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ge</span> <span class="operator">=</span> gt;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">pivot1</span> <span class="operator">=</span> nums[lo];</span><br><span class="line">        <span class="type">int</span> <span class="variable">pivot2</span> <span class="operator">=</span> nums[hi];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pivot1 &gt; pivot2) &#123;</span><br><span class="line">            exchange(nums, lo, hi);</span><br><span class="line">            pivot1 = nums[lo];</span><br><span class="line">            pivot2 = nums[hi];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> lo;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (j &lt; ge) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] == pivot1) &#123;</span><br><span class="line">                exchange(nums, ++le, j++);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[j] &lt; pivot1) &#123;</span><br><span class="line">                <span class="keyword">if</span> (le == lt) &#123;</span><br><span class="line">                    ++lt;</span><br><span class="line">                    ++le;</span><br><span class="line">                    exchange(nums, lt, j++);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    exchange(nums, ++lt, j);</span><br><span class="line">                    exchange(nums, ++le, j++);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[j] == pivot2) &#123;</span><br><span class="line">                exchange(nums, --ge, j);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[j] &gt; pivot2) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ge == gt) &#123;</span><br><span class="line">                    --gt;</span><br><span class="line">                    --ge;</span><br><span class="line">                    exchange(nums, gt, j);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    exchange(nums, --gt, j);</span><br><span class="line">                    exchange(nums, --ge, j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;lt, le, ge, gt&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于双轴快排的更多实现可以参考JDK Arrays.sort的源码 <a href="/2017/07/25/SourceAnalysis-DualPivotQuickSort/" title="SourceAnalysis-DualPivotQuickSort">SourceAnalysis-DualPivotQuickSort</a></p>
<h1 id="6-counting-sort"><a class="markdownIt-Anchor" href="#6-counting-sort"></a> 6 Counting Sort</h1>
<p>计数排序复杂度是O(n)，以牺牲空间复杂度来提高时间效率。适用于可枚举且范围较小的类型的排序，例如short、char、byte等</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (num &lt; min) &#123;</span><br><span class="line">                min = num;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (num &gt; max) &#123;</span><br><span class="line">                max = num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> max - min + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span>[] counts = <span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            counts[num - min]++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; counts.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> counts[i];</span><br><span class="line">            <span class="keyword">while</span> (count-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                nums[index++] = min + i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">LEN</span> <span class="operator">=</span> <span class="number">500000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TIMES</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">duration</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>; t &lt; TIMES; t++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span>[] nums = <span class="keyword">new</span> <span class="title class_">int</span>[LEN];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; LEN; i++) &#123;</span><br><span class="line">                nums[i] = random.nextInt(<span class="number">100000</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            sort(nums);</span><br><span class="line"></span><br><span class="line">            duration += System.currentTimeMillis() - start;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[j] &lt; nums[j - <span class="number">1</span>]) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.format(<span class="string">&quot;%-20s : %d ms\n&quot;</span>, <span class="string">&quot;CountSort&quot;</span>, duration);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n------------------------------------------\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="7-bitonic-sort"><a class="markdownIt-Anchor" href="#7-bitonic-sort"></a> 7 Bitonic Sort</h1>
<p><strong><code>Bitonic Sequence</code>又称为双调序列，即一个长为<code>2^n</code>的序列，前半部分递增，后半部分递减（当然也可以反过来）。特别地，当<code>n = 1</code>时，即仅包含两个元素的序列也是双调序列</strong></p>
<p>下面以一个例子来说明，如何利用双调序列来进行排序，原始序列如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3    7     4    8     6    2     1    5</span><br></pre></td></tr></table></figure>
<p>由于当<code>n = 1</code>时，已经是4个双调序列了，分别为<code>(3, 7)</code>、<code>(4, 8)</code>、<code>(6, 2)</code>、<code>(1, 5)</code>。因此，我们下一步需要构造2个<code>(n + 1) = 2</code>的双调序列，此时：</p>
<ul>
<li><code>current distance, cd = 2^(n-1) = 1 | n = 1</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">group 1 │ group 2  │ group 3  │ group 4</span><br><span class="line">        │          │          │</span><br><span class="line">3    7  │  4    8  │  6    2  │  1    5</span><br><span class="line"></span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line"></span><br><span class="line">      group 1      │       group 2</span><br><span class="line">                   │</span><br><span class="line">3    7     4    8  │  6    2     1    5</span><br><span class="line">│    ▲     ▲    │  │  │    ▲     ▲    │</span><br><span class="line">└────┘     └─sw─┘  │  └─sw─┘     └─sw─┘</span><br><span class="line">        │          │          │</span><br><span class="line">        ▼          │          ▼</span><br><span class="line">3    7     8    4  │  2    6     5    1</span><br></pre></td></tr></table></figure>
<p>此时，我们得到了2个<code>n = 2</code>的双调序列，分别为<code>(3, 7, 8, 4)</code>、<code>(2, 6, 5, 1)</code>，因此，我们下一步需要构造1个<code>(n + 1) = 3</code>的双调序列，此时：</p>
<ul>
<li><code>cd = 2^(n-1) = 2 | n = 2</code></li>
<li><code>cd = cd / 2 = 1</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">      group 1      │      group 2</span><br><span class="line">                   │</span><br><span class="line">3    7     8    4  │  2    6     5    1</span><br><span class="line"></span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line"></span><br><span class="line">                group 1</span><br><span class="line"></span><br><span class="line">3    7     8    4     2    6     5    1</span><br><span class="line">│    │     ▲    ▲     ▲    ▲     │    │</span><br><span class="line">└────┼─────┘    │     └────┬─sw──┘    │</span><br><span class="line">     │          │          │          │</span><br><span class="line">     └────sw────┘          └──────────┘</span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line">3    4     8    7     5    6     2    1</span><br><span class="line">│    ▲     │    ▲     ▲    │     ▲    │</span><br><span class="line">└────┘     └─sw─┘     └─sw─┘     └────┘</span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line">3    4     7    8     6    5     2    1</span><br></pre></td></tr></table></figure>
<p>此时，我们得到了1个<code>n = 3</code>的双调序列，即<code>(3, 4, 7, 8, 6, 5, 2, 1)</code>，因此，我们下一步需要构造1个<code>(n + 1) = 4</code>的双调序列，此时：</p>
<ul>
<li>由于原序列只有8个元素，因此我们只关注左半部分即可（升序的半边），这是双调序列可用于排序的精妙所在（双调排序）</li>
<li><code>cd = 2^(n-1) = 4 | n = 3</code></li>
<li><code>cd = cd/2 = 2</code></li>
<li><code>cd = cd/2 = 1</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">                group 1</span><br><span class="line"></span><br><span class="line">3    4     7    8     6    5     2    1</span><br><span class="line">                  │</span><br><span class="line">                  ▼</span><br><span class="line"></span><br><span class="line">                            group 1</span><br><span class="line"></span><br><span class="line">3    4     7    8     6    5     2    1   x x x x x x x x</span><br><span class="line">│    │     │    │     ▲    ▲     ▲    ▲</span><br><span class="line">└────┼─────┼────┼─────┘    │     │    │</span><br><span class="line">     │     │    │          │     │    │</span><br><span class="line">     └─────┼────┼──────────┘     │    │</span><br><span class="line">           │    │                │    │</span><br><span class="line">           └────┼────sw──────────┘    │</span><br><span class="line">                │                     │</span><br><span class="line">                └──────────sw─────────┘</span><br><span class="line"></span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line">3    4     2    1     6    5     7    8   x x x x x x x x</span><br><span class="line">│    │     ▲    ▲     │    │     ▲    ▲</span><br><span class="line">└──sw├─────┘    │     └────┼─────┘    │</span><br><span class="line">     │          │          │          │</span><br><span class="line">     └────sw────┘          └──────────┘</span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line">2    1     3    4     6    5     7    8   x x x x x x x x</span><br><span class="line">│    ▲     │    ▲     │    ▲     │    ▲</span><br><span class="line">└─sw─┘     └────┘     └─sw─┘     └────┘</span><br><span class="line">                   │</span><br><span class="line">                   ▼</span><br><span class="line">1    2     3    4     5    6     7    8   x x x x x x x x</span><br></pre></td></tr></table></figure>
<p>此时，我们得到了一个<code>n = 4</code>的双调序列，即<code>(1, 2, 3, 4, 5, 6, 7, 8, x, x, x, x, x, x, x, x)</code>，升序部分就是排序的输出</p>
<h2 id="71-参考"><a class="markdownIt-Anchor" href="#71-参考"></a> 7.1 参考</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=w544Rn4KC8I">Bitonic Merge Sort | Explanation and Code Tutorial | Everything you need to know!</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.rice.edu/confluence/download/attachments/4435861/comp322-s12-lec28-slides-JMC.pdf?version=1&amp;modificationDate=1333163955158">Bitonic Sort</a></li>
</ul>
<h1 id="8-parallel-merge-sort"><a class="markdownIt-Anchor" href="#8-parallel-merge-sort"></a> 8 Parallel Merge Sort</h1>
<p>思路：假设有<code>N</code>路输入，每路有序，先统计这<code>N</code>路数据的分布，找到<code>N-1</code>个分界点（切<code>N-1</code>刀变<code>N</code>块），每路输入按照这<code>N-1</code>个分界点对数据进行shuffle，分别送入<code>N</code>路输入中。这样<code>N</code>路输入就不相交了，每路再进行归并，最后直接合并即可</p>
<h2 id="81-merge-path"><a class="markdownIt-Anchor" href="#81-merge-path"></a> 8.1 Merge Path</h2>
<p><a href="/resources/paper/Merge-Path-A-Visually-Intuitive-Approach-to-Parallel-Merging.pdf">Merge Path - A Visually Intuitive Approach</a></p>
<h2 id="82-pipelined-multi-staged-merge-sort"><a class="markdownIt-Anchor" href="#82-pipelined-multi-staged-merge-sort"></a> 8.2 Pipelined Multi-staged Merge Sort</h2>
<p><a href="/resources/paper/Parallel-Merge-Sort.pdf">Parallel Merge Sort</a></p>
<h1 id="9-approx-top-k"><a class="markdownIt-Anchor" href="#9-approx-top-k"></a> 9 Approx Top K</h1>
<p><a href="/resources/paper/Efficient-Computation-of-Frequent-and-Top-k-Elements-in-Data-Streams.pdf">Efficient Computation of Frequent and Top-k Elements in Data Streams </a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ItemCounter</span> &#123;</span><br><span class="line">    <span class="type">int32_t</span> item;</span><br><span class="line">    <span class="type">size_t</span> counter;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpaceSaved</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::unordered_map&lt;<span class="type">int32_t</span>, ItemCounter*&gt; _table;</span><br><span class="line">    std::vector&lt;ItemCounter&gt; _counters;</span><br><span class="line">    <span class="type">size_t</span> empty_idx = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">SpaceSaved</span>(<span class="type">int32_t</span> k) : _counters(k) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int32_t</span> item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (_table.<span class="built_in">find</span>(item) != _table.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            _table[item]-&gt;counter++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (empty_idx &lt; _counters.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                ItemCounter* empty_counter = &amp;_counters[empty_idx++];</span><br><span class="line">                empty_counter-&gt;item = item;</span><br><span class="line">                empty_counter-&gt;counter = <span class="number">1</span>;</span><br><span class="line">                _table[item] = empty_counter;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ItemCounter* minCounter = &amp;_counters[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; counter : _counters) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (counter.counter &lt; minCounter-&gt;counter) &#123;</span><br><span class="line">                        minCounter = &amp;counter;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                _table.<span class="built_in">erase</span>(minCounter-&gt;item);</span><br><span class="line">                minCounter-&gt;item = item;</span><br><span class="line">                minCounter-&gt;counter++;</span><br><span class="line">                _table[item] = minCounter;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::vector&lt;ItemCounter&gt; <span class="title">get_frequent_items</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> _counters; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">SpaceSaved <span class="title">ss</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A simple test case</span></span><br><span class="line">    std::vector&lt;<span class="type">int32_t</span>&gt; stream = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int32_t</span> item : stream) &#123;</span><br><span class="line">        ss.<span class="built_in">process</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> frequentItems = ss.<span class="built_in">get_frequent_items</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; entry : frequentItems) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Item: &quot;</span> &lt;&lt; entry.item &lt;&lt; <span class="string">&quot;, Count: &quot;</span> &lt;&lt; entry.counter &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="91-two-stage-aggregation"><a class="markdownIt-Anchor" href="#91-two-stage-aggregation"></a> 9.1 Two-stage Aggregation</h2>
<p>The Space Saving Algorithm is commonly used for estimating the top-K frequent items in a stream of data with limited memory. To implement this as a two-stage aggregate function for a distributed database management system (DBMS), you’ll need to handle the aggregation in two main phases:</p>
<ol>
<li><code>Local Aggregation</code> (First-stage aggregate on each node)</li>
<li><code>Global Aggregation</code> (Second-stage aggregate on a single node)</li>
</ol>
<p>Here’s how you can design and execute the two-stage aggregation:</p>
<p><strong>Local Aggregation (First-stage):</strong> Each node will maintain a list of counters based on the Space Saving Algorithm:</p>
<ol>
<li>For each incoming item in the stream:
<ol>
<li>If the item is already in the list of counters, increment its count.</li>
<li>If the item is not in the list and there is space available, add it to the list with a count of 1.</li>
<li>If the item is not in the list and there is no space available, find the item with the smallest count, replace it with the new item and increment the count of the new item.</li>
</ol>
</li>
<li>At the end of this phase, each node will have its local top-K counters.</li>
</ol>
<p><strong>Global Aggregation (Second-stage):</strong> After the local aggregation phase, the intermediate counters from all nodes will be sent to a particular aggregation node. On this node:</p>
<ol>
<li>For each counter from the nodes:
<ol>
<li>If the item is already in the global list of counters, add the local count to the global count.</li>
<li>If the item is not in the global list and there is space available, add it to the global list with its local count.</li>
<li>If the item is not in the global list and there is no space available, determine if its local count is greater than the smallest global counter. If it is, replace the global counter with the new item and its count. Otherwise, discard the counter.</li>
</ol>
</li>
<li>Once all the local counters have been processed, the global list will contain the estimated top-K frequent items across all the nodes.</li>
</ol>
<p><strong>Some considerations:</strong></p>
<ul>
<li>Due to the nature of the Space Saving Algorithm, the accuracy of the results will depend on the number of counters you maintain in your list. The more counters you have, the more accurate the result, but at the cost of increased memory usage.</li>
<li>In the global aggregation phase, you might be merging a lot of counters, especially if you have many nodes. Ensure your global counter list is sufficiently large to maintain accuracy.</li>
<li>Depending on the distribution of your data across nodes, there might be significant overlap between local top-K items. This can make your global results more accurate.</li>
<li>Implementing the Space Saving Algorithm for a distributed DBMS can be a challenging task, but with careful design and attention to detail, it’s possible to get accurate top-K estimations with limited memory.</li>
</ul>
<h1 id="10-总结"><a class="markdownIt-Anchor" href="#10-总结"></a> 10 总结</h1>
<table>
<thead>
<tr>
<th style="text-align:left">排序算法</th>
<th style="text-align:left">是否稳定</th>
<th style="text-align:left">是否原址</th>
<th style="text-align:left">复杂度</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">冒泡排序</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td style="text-align:left">O(N2)</td>
</tr>
<tr>
<td style="text-align:left">插入排序</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td style="text-align:left">O(N2)</td>
</tr>
<tr>
<td style="text-align:left">归并排序</td>
<td style="text-align:left">是</td>
<td style="text-align:left">否</td>
<td style="text-align:left">O(NlgN)</td>
</tr>
<tr>
<td style="text-align:left">堆排序</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">O(NlgN)</td>
</tr>
<tr>
<td style="text-align:left">快速排序</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">O(NlgN)</td>
</tr>
<tr>
<td style="text-align:left">计数排序</td>
<td style="text-align:left">是(对于基本类型)</td>
<td style="text-align:left">否</td>
<td style="text-align:left">O(N)</td>
</tr>
</tbody>
</table>
<p><strong>可以用leetcode第912题来验证算法是否正确</strong></p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag"># 原创</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/07/25/SourceAnalysis-DualPivotQuickSort/" rel="prev" title="SourceAnalysis-DualPivotQuickSort">
      <i class="fa fa-chevron-left"></i> SourceAnalysis-DualPivotQuickSort
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/07/27/SourceAnalysis-DynamicProxy/" rel="next" title="SourceAnalysis-DynamicProxy">
      SourceAnalysis-DynamicProxy <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-livere">livere</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane livere" id="comment-livere">
              
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zMzY0My8xMDE5OA=="></div>
  </div>
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-bubble-sort"><span class="nav-text"> 1 Bubble Sort</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-insertion-sort"><span class="nav-text"> 2 Insertion Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#21-%E7%BB%8F%E5%85%B8%E7%89%88%E6%9C%AC"><span class="nav-text"> 2.1 经典版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-%E4%BA%8C%E5%88%86%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="nav-text"> 2.2 二分插入排序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-merge-sort"><span class="nav-text"> 3 Merge Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#31-paralle-merge"><span class="nav-text"> 3.1 Paralle Merge</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-heap-sort"><span class="nav-text"> 4 Heap Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#41-topk"><span class="nav-text"> 4.1 TopK</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-quick-sort"><span class="nav-text"> 5 Quick Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#51-2-way-quick-sort"><span class="nav-text"> 5.1 2-way Quick Sort</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#52-3-way-quick-sort"><span class="nav-text"> 5.2 3-way Quick Sort</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#53-dual-pivot-quick-sort"><span class="nav-text"> 5.3 Dual-Pivot Quick Sort</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-counting-sort"><span class="nav-text"> 6 Counting Sort</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-bitonic-sort"><span class="nav-text"> 7 Bitonic Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#71-%E5%8F%82%E8%80%83"><span class="nav-text"> 7.1 参考</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-parallel-merge-sort"><span class="nav-text"> 8 Parallel Merge Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#81-merge-path"><span class="nav-text"> 8.1 Merge Path</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#82-pipelined-multi-staged-merge-sort"><span class="nav-text"> 8.2 Pipelined Multi-staged Merge Sort</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-approx-top-k"><span class="nav-text"> 9 Approx Top K</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#91-two-stage-aggregation"><span class="nav-text"> 9.1 Two-stage Aggregation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-%E6%80%BB%E7%BB%93"><span class="nav-text"> 10 总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Liuyehcf"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Liuyehcf</p>
  <div class="site-description" itemprop="description">大音希声，大象无形</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">288</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">98</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liuyehcf</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qhEhLuMeMOy1zgcBhkqUS6P8-gzGzoHsz',
      appKey     : 'uhkruDLNLNdL5rQjRBY2X9Ke',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
